# 云环境配置修改注意事项

我整理了项目中所有涉及云环境配置的地方，在更换环境时需要修改这些配置

## 1. 云环境ID配置

### 1.1 小程序初始化配置

- `front/app.js` (第13行)
  
  ```javascript
  wx.cloud.init({ env: "cloud1-7gomrs3ufe613311" });
  ```

### 1.2 云函数初始化配置

- `cloudfunctions/dietLog/index.js` (第2行)
  
  ```javascript
  cloud.init({ env: "cloud1-7gomrs3ufe613311"})//初始化云开发环境，支持自动匹配和指定
  ```
  
- `cloudfunctions/foodRecognition/index.js` (第4行)
  ```javascript
  cloud.init({ env: "cloud1-7gomrs3ufe613311" }) // 统一云环境配置
  ```

- `cloudfunctions/getDietHistory/index.js` (第4行)
  
  ```javascript
  cloud.init({ env: "cloud1-7gomrs3ufe613311" })
  ```
  
- `cloudfunctions/mealReminder/index.js` (第3行)
  ```javascript
  cloud.init({ env: "cloud1-7gomrs3ufe613311" })
  ```

### 1.3 页面组件中的环境ID配置

- `front/pages/diet/diet.js` (第8行)
  
  ```javascript
  envId: 'cloud1-7gomrs3ufe613311', // 我的（jak-ma）云环境ID
  ```
  该环境ID在以下位置被引用：
  - 第119行: `envId: this.data.envId`
  - 第174行: `envId: this.data.envId`
  - 第207行: `envId: this.data.envId`
  - 第603行: `config: { env: this.data.envId }`

## 2. 第三方API配置

### 2.1 百度AI食物识别API配置(考虑更换api)

- `cloudfunctions/foodRecognition/index.js` (第7-9行)
  ```javascript
  const APP_ID = "118570866"
  const API_KEY = "kLrjWTJXSdfpYyEsbvnGgj3g"
  const SECRET_KEY = "b7Vy6nrMoYNO15uTxrT5WTbbM3RYoS7F"
  ```

### 2.2 心知天气API配置

- `front/pages/weather/weather.js` (第14行)
  
  ```javascript
  apiKey: 'SAXdsW40FvsGmeLpd' // 心知天气API密钥，需要替换为实际的API密钥
  ```
  
- `front/pages/index/index.js` (第23行)
  ```javascript
  apiKey: 'SAXdsW40FvsGmeLpd', // 心知天气API密钥
  ```

## 3. 小程序配置

- `project.config.json` (第3行)
  
  ```json
  "appid": "wx840b5123be1de053",
  ```

## 4. 数据库集合名称

以下是项目中使用的数据库集合名称，在迁移环境时需确保这些集合存在：

- `diet_logs`: 饮食日志集合
  - 在 `cloudfunctions/dietLog/index.js` 第9行
  - 在 `cloudfunctions/dietLog/handlers/addRecord.js` 第49行
  - 在 `cloudfunctions/dietLog/handlers/getRecords.js` 第15行
  - 在 `cloudfunctions/getDietHistory/index.js` 第11行

- `meal_reminders`: 用餐提醒集合
  - 在 `cloudfunctions/mealReminder/index.js` 第17、26、38、48、56行

- `healthRecords`: 健康记录集合
  - 在 `front/pages/health/health.js` 第39、67、91行

- `users`: 用户集合
  - 在 `front/app.js` 第38、82行

- `medecineremind`: 用药提醒集合
  - 在 `front/pages/reminder/reminder.js` 第45、64、77、134、162、204、257、279行

## 5. 云函数配置文件

- `cloudfunctions/getDietHistory/config.json` 包含数据库权限和定时触发器配置

## 6. 环境变更注意事项

更换环境时，需要同时修改以下内容：

1. 所有云环境ID (`cloud1-7gomrs3ufe613311`)
2. 确保新环境中创建了所有必要的数据库集合
3. 更新第三方API密钥（百度AI、心知天气）（大家不用更换，先不用管这个）
4. 检查云函数配置文件中的权限设置
5. 确保小程序appid正确配置