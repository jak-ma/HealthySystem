!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):((t="undefined"!=typeof globalThis?globalThis:t||self).G=t.G||{},t.G.Gesture=e())}(this,(function(){"use strict";var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};var e={exports:{}};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function i(t,e,r,i,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||t,s),c=n?n+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],a]:t._events[c].push(a):(t._events[c]=a,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,r,o=[];if(0===this._eventsCount)return o;for(r in t=this._events)e.call(t,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},a.prototype.listeners=function(t){var e=this._events[n?n+t:t];if(!e)return[];if(e.fn)return[e.fn];for(var r=0,o=e.length,i=Array(o);o>r;r++)i[r]=e[r].fn;return i},a.prototype.listenerCount=function(t){var e=this._events[n?n+t:t];return e?e.fn?1:e.length:0},a.prototype.emit=function(t,e,r,o,i,s){var a=n?n+t:t;if(!this._events[a])return!1;var c,p,v=this._events[a],u=arguments.length;if(v.fn){switch(v.once&&this.removeListener(t,v.fn,void 0,!0),u){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,e),!0;case 3:return v.fn.call(v.context,e,r),!0;case 4:return v.fn.call(v.context,e,r,o),!0;case 5:return v.fn.call(v.context,e,r,o,i),!0;case 6:return v.fn.call(v.context,e,r,o,i,s),!0}for(p=1,c=Array(u-1);u>p;p++)c[p-1]=arguments[p];v.fn.apply(v.context,c)}else{var f,l=v.length;for(p=0;l>p;p++)switch(v[p].once&&this.removeListener(t,v[p].fn,void 0,!0),u){case 1:v[p].fn.call(v[p].context);break;case 2:v[p].fn.call(v[p].context,e);break;case 3:v[p].fn.call(v[p].context,e,r);break;case 4:v[p].fn.call(v[p].context,e,r,o);break;default:if(!c)for(f=1,c=Array(u-1);u>f;f++)c[f-1]=arguments[f];v[p].fn.apply(v[p].context,c)}}return!0},a.prototype.on=function(t,e,n){return i(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return i(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,r,o){var i=n?n+t:t;if(!this._events[i])return this;if(!e)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||o&&!a.once||r&&a.context!==r||s(this,i);else{for(var c=0,p=[],v=a.length;v>c;c++)(a[c].fn!==e||o&&!a[c].once||r&&a[c].context!==r)&&p.push(a[c]);p.length?this._events[i]=1===p.length?p[0]:p:s(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?this._events[e=n?n+t:t]&&s(this,e):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a}(e);var n="object"==typeof performance&&performance.now?performance:Date,r=function(t,e){var n=e.x-t.x,r=e.y-t.y;return Math.abs(n)>Math.abs(r)?n>0?"right":"left":r>0?"down":"up"},o=function(t,e){var n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return Math.sqrt(n*n+r*r)},i=function(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}};return function(e){function s(t){var s=e.call(this)||this;return s.evCache=[],s.startPoints=[],s.processEvent={},s.throttleTimer=0,s.emitThrottles=[],s._start=function(t){s.reset(),s.startTime=n.now();var e=s.evCache,r=s.startPoints;t&&e.push({pointerId:t.pointerId,x:t.x,y:t.y,ev:t});r.length=e.length;for(var a=0;e.length>a;a++){var c=e[a];r[a]={x:c.x,y:c.y}}if(1!==r.length)s.startDistance=o(r[0],r[1]),s.center=i(r[0],r[1]);else{var p=e[0].ev;s.pressTimeout=setTimeout((function(){var t="press",e="none";p.direction=e,p.deltaX=0,p.deltaY=0,p.points=r,s.emitStart(t,p),s.emit(t,p),s.eventType=t,s.direction=e}),250)}},s._move=function(t){s.clearPressTimeout();var e=s.startPoints,a=s.evCache;if(e.length){for(var c=t.x,p=t.y,v=t.pointerId,u=!1,f=0,l=a.length;l>f;f++)if(v===a[f].pointerId){a[f]={pointerId:v,x:c,y:p,ev:t},u=!0;break}if(!u)e.push({x:c,y:p}),a.push({pointerId:v,x:c,y:p,ev:t}),s.startDistance=o(e[0],e[1]),s.center=i(e[0],e[1]);var h={x:c,y:p},y=a.map((function(t){return{x:t.x,y:t.y}})),m=n.now();if(s.prevMoveTime=s.lastMoveTime,s.prevMovePoint=s.lastMovePoint,s.lastMoveTime=m,s.lastMovePoint=h,1===e.length){var d=e[0],_=c-d.x,x=p-d.y,T=s.direction||r(d,h);s.direction=T;var b=s.getEventType(h);return t.direction=T,t.deltaX=_,t.deltaY=x,t.points=y,s.emitStart(b,t),void s.emit(b,t)}var g=s.startDistance,w=o(y[0],y[1]);t.zoom=w/g,t.center=s.center,t.points=y,s.emitStart("pinch",t),s._throttleEmit("pinch",t)}},s._end=function(t){var e=s.evCache,i=s.startPoints,a=e.map((function(t){return{x:t.x,y:t.y}}));if(t.points=a,s.emitEnd(t),1===e.length){var c=n.now(),p=s.lastMoveTime;if(100>c-p){var v=p-(s.prevMoveTime||s.startTime);if(v>0){var u=s.prevMovePoint||i[0],f=s.lastMovePoint||i[0],l=o(u,f)/v;l>.3&&(t.velocity=l,t.direction=r(u,f),s.emit("swipe",t))}}}for(var h=0,y=e.length;y>h;h++)if(e[h].pointerId===t.pointerId){e.splice(h,1),i.splice(h,1);break}s.reset(),e.length>0&&s._start()},s._cancel=function(t){var e=s.evCache.map((function(t){return{x:t.x,y:t.y}}));t.points=e,s.emitEnd(t),s.evCache=[],s.reset()},s.el=t,s._initEvent(),s}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+n+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}(s,e),s.prototype._initEvent=function(){var t=this.el;t.addEventListener("pointerdown",this._start),t.addEventListener("pointermove",this._move),t.addEventListener("pointerup",this._end),t.addEventListener("pointercancel",this._cancel),t.addEventListener("pointerupoutside",this._end)},s.prototype.getEventType=function(t){var e,r=this,i=r.eventType,s=r.startTime,a=r.startPoints;if(i)return i;this._events.pan?e=n.now()-s>250&&10>o(a[0],t)?"press":"pan":e="press";return this.eventType=e,e},s.prototype.enable=function(t){this.processEvent[t]=!0},s.prototype.isProcess=function(t){return this.processEvent[t]},s.prototype.emitStart=function(t,e){this.isProcess(t)||(this.enable(t),this.emit("".concat(t,"start"),e))},s.prototype._throttleEmit=function(t,e){var n,r,o=this;this.pushEvent(t,e);var i=this,s=i.el,a=i.emitThrottles,c=i.processEvent;if(!i.throttleTimer){var p=(null===(n=s.ownerDocument)||void 0===n?void 0:n.defaultView)||(null===(r=s.document)||void 0===r?void 0:r.defaultView);this.throttleTimer=p.requestAnimationFrame((function(){for(var t=0,e=a.length;e>t;t++){var n=a[t],r=n.type;c[r]&&o.emit(r,n.ev)}o.throttleTimer=0,o.emitThrottles.length=0}))}},s.prototype.emitEnd=function(t){var e=this,n=this.processEvent;Object.keys(n).forEach((function(r){e.emit("".concat(r,"end"),t),delete n[r]}))},s.prototype.pushEvent=function(t,e){for(var n=this.emitThrottles,r={type:t,ev:e},o=0,i=n.length;i>o;o++)if(n[o].type===t)return void n.splice(o,1,r);n.push(r)},s.prototype.clearPressTimeout=function(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)},s.prototype.reset=function(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null},s}(e.exports)}));
//# sourceMappingURL=index.umd.min.js.map
