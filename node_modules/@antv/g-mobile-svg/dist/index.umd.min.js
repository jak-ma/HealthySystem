!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@antv/g-lite")):"function"==typeof define&&define.amd?define(["exports","@antv/g-lite"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).G=t.G||{},t.G.MobileSVG={}),t.window.G)}(this,(function(t,e){"use strict";var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},n(t,e)};function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+e+" is not a constructor or null");function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var i=function(){return i=Object.assign||function(t){for(var e,n=1,r=arguments.length;r>n;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},i.apply(this,arguments)};function o(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{s(r.next(t))}catch(t){o(t)}}function c(t){try{s(r.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,c)}s((r=r.apply(t,e||[])).next())}))}function a(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&c[0]?r.return:c[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,c[1])).done)return i;switch(r=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!i||c[1]>i[0]&&i[3]>c[1])){a.label=c[1];break}if(6===c[0]&&i[1]>a.label){a.label=i[1],i=c;break}if(i&&i[2]>a.label){a.label=i[2],a.ops.push(c);break}i[2]&&a.ops.pop(),a.trys.pop();continue}c=e.call(t,a)}catch(t){c=[6,t],r=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}function c(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function s(t,e,n){if(n||2===arguments.length)for(var r,i=0,o=e.length;o>i;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}var l="undefined"!=typeof Float32Array?Float32Array:Array;function u(){var t=new l(16);return l!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function d(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],c=e[5],s=e[6],l=e[7],u=e[8],d=e[9],p=e[10],h=e[11],f=e[12],v=e[13],m=e[14],g=e[15],y=n*c-r*a,b=n*s-i*a,E=n*l-o*a,A=r*s-i*c,S=r*l-o*c,x=i*l-o*s,T=u*v-d*f,C=u*m-p*f,w=u*g-h*f,P=d*m-p*v,M=d*g-h*v,k=p*g-h*m,O=y*k-b*M+E*P+A*w-S*C+x*T;return O?(t[0]=(c*k-s*M+l*P)*(O=1/O),t[1]=(i*M-r*k-o*P)*O,t[2]=(v*x-m*S+g*A)*O,t[3]=(p*S-d*x-h*A)*O,t[4]=(s*w-a*k-l*C)*O,t[5]=(n*k-i*w+o*C)*O,t[6]=(m*E-f*x-g*b)*O,t[7]=(u*x-p*E+h*b)*O,t[8]=(a*M-c*w+l*T)*O,t[9]=(r*w-n*M-o*T)*O,t[10]=(f*S-v*E+g*y)*O,t[11]=(d*E-u*S-h*y)*O,t[12]=(c*C-a*P-s*T)*O,t[13]=(n*P-r*C+i*T)*O,t[14]=(v*b-f*A-m*y)*O,t[15]=(u*A-d*b+p*y)*O,t):null}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var p=function(t){return null==t},h={}.toString,f=function(t,e){return h.call(t)==="[object "+e+"]"},v=function(t){return f(t,"String")},m=function(t,e,n){return e>t?e:t>n?n:t},g=function(){function t(t){this.dragndropPluginOptions=t}return t.prototype.apply=function(e){var n=this,r=e.renderingService,i=e.renderingContext.root.ownerDocument,c=i.defaultView,s=function(t){var e=t.target,r=e===i,s=r&&n.dragndropPluginOptions.isDocumentDraggable?i:e.closest&&e.closest("[draggable=true]");if(s){var l=!1,u=t.timeStamp,d=[t.clientX,t.clientY],p=null,h=[t.clientX,t.clientY],f=function(t){return o(n,void 0,void 0,(function(){var n,o,c,f,v,m;return a(this,(function(a){switch(a.label){case 0:if(!l){if(n=t.timeStamp-u,o=Math.sqrt(((g=[t.clientX,t.clientY])[0]-(y=d)[0])*(g[0]-y[0])+(g[1]-y[1])*(g[1]-y[1])),this.dragndropPluginOptions.dragstartTimeThreshold>=n||this.dragndropPluginOptions.dragstartDistanceThreshold>=o)return[2];t.type="dragstart",s.dispatchEvent(t),l=!0}return t.type="drag",t.dx=t.clientX-h[0],t.dy=t.clientY-h[1],s.dispatchEvent(t),h=[t.clientX,t.clientY],r?[3,2]:(c="pointer"===this.dragndropPluginOptions.overlap?[t.canvasX,t.canvasY]:e.getBounds().center,[4,i.elementsFromPoint(c[0],c[1])]);case 1:f=a.sent(),v=f[f.indexOf(e)+1],m=(null==v?void 0:v.closest("[droppable=true]"))||(this.dragndropPluginOptions.isDocumentDroppable?i:null),p!==m&&(p&&(t.type="dragleave",t.target=p,p.dispatchEvent(t)),m&&(t.type="dragenter",t.target=m,m.dispatchEvent(t)),(p=m)&&(t.type="dragover",t.target=p,p.dispatchEvent(t))),a.label=2;case 2:return[2]}var g,y}))}))};c.addEventListener("pointermove",f);var v=function(t){if(l){t.detail={preventClick:!0};var e=t.clone();p&&(e.type="drop",e.target=p,p.dispatchEvent(e)),e.type="dragend",s.dispatchEvent(e),l=!1}c.removeEventListener("pointermove",f)};e.addEventListener("pointerup",v,{once:!0}),e.addEventListener("pointerupoutside",v,{once:!0})}};r.hooks.init.tap(t.tag,(function(){c.addEventListener("pointerdown",s)})),r.hooks.destroy.tap(t.tag,(function(){c.removeEventListener("pointerdown",s)}))},t.tag="Dragndrop",t}(),y=function(t){function e(e){void 0===e&&(e={});var n=t.call(this)||this;return n.options=e,n.name="dragndrop",n}return r(e,t),e.prototype.init=function(){this.addRenderingPlugin(new g(i({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e.prototype.setOptions=function(t){Object.assign(this.plugins[0].dragndropPluginOptions,t)},e}(e.AbstractRendererPlugin),b=function(){function t(){}return t.prototype.apply=function(e){var n=e.renderingService,r=e.config,i=e.contextService.getDomElement(),o=function(t){n.hooks.pointerDown.call(t)},a=function(t){n.hooks.pointerUp.call(t)},c=function(t){n.hooks.pointerMove.call(t)},s=function(t){n.hooks.pointerOver.call(t)},l=function(t){n.hooks.pointerOut.call(t)},u=function(t){n.hooks.click.call(t)},d=function(t){n.hooks.pointerCancel.call(t)};n.hooks.init.tap(t.tag,(function(){i.addEventListener("touchstart",o,!0),i.addEventListener("touchend",a,!0),i.addEventListener("touchmove",c,!0),i.addEventListener("touchcancel",d,!0),i.addEventListener("mouseout",l,!0),i.addEventListener("mouseover",s,!0),r.useNativeClickEvent&&i.addEventListener("click",u,!0)})),n.hooks.destroy.tap(t.tag,(function(){i.removeEventListener("touchstart",o,!0),i.removeEventListener("touchend",a,!0),i.removeEventListener("touchmove",c,!0),i.removeEventListener("touchcancel",d,!0),i.removeEventListener("mouseout",l,!0),i.removeEventListener("mouseover",s,!0),r.useNativeClickEvent&&i.removeEventListener("click",u,!0)}))},t.tag="MobileInteraction",t}(),E=function(t){function e(){var e=t.apply(this,s([],c(arguments),!1))||this;return e.name="mobile-interaction",e}return r(e,t),e.prototype.init=function(){this.addRenderingPlugin(new b)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(e.AbstractRendererPlugin),A=Object.freeze({__proto__:null,Plugin:E}),S=function(){function t(){}return t.prototype.apply=function(e,n){var r=this,i=e.config.document,c=e.renderingService,s=e.svgElementMap;c.hooks.pick.tapPromise(t.tag,(function(t){return o(r,void 0,void 0,(function(){return a(this,(function(e){return[2,this.pick(s,i,t)]}))}))})),c.hooks.pickSync.tap(t.tag,(function(t){return r.pick(s,i,t)}))},t.prototype.pick=function(t,e,n){var r,i,o=n.topmost,a=n.position,c=a.clientX,s=a.clientY;try{var l=[];try{for(var u=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}((e||document).elementsFromPoint(c,s)),d=u.next();!d.done;d=u.next()){var p=d.value;if(p.shadowRoot&&p.shadowRoot!==e)return this.pick(t,p.shadowRoot,n);var h=t.get(p);if(h&&h.isInteractive()&&(l.push(h),o))return n.picked=l,n}}catch(t){r={error:t}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}n.picked=l}catch(t){n.picked=[]}return n},t.tag="SVGPicker",t}(),x=function(t){function e(){var e=t.apply(this,s([],c(arguments),!1))||this;return e.name="svg-picker",e}return r(e,t),e.prototype.init=function(){this.addRenderingPlugin(new S)},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(e.AbstractRendererPlugin),T=Object.freeze({__proto__:null,Plugin:x}),C=function(){function t(){}return t.tag="c-svg-element",t}();function w(t,e){var n=e.img,r=void 0===n?"":n,i=e.width,o=e.height;if(t.setAttribute("x","0"),t.setAttribute("y","0"),v(r))t.setAttribute("href",r);else if(r instanceof Image)i||t.setAttribute("width","".concat(r.width)),o||t.setAttribute("height","".concat(r.height)),t.setAttribute("href",r.src);else if(r instanceof HTMLElement&&v(r.nodeName)&&"CANVAS"===r.nodeName.toUpperCase())t.setAttribute("href",r.toDataURL());else if(r instanceof ImageData){var a=document.createElement("canvas");a.setAttribute("width","".concat(r.width)),a.setAttribute("height","".concat(r.height));var c=a.getContext("2d");c&&(c.putImageData(r,0,0),i||t.setAttribute("width","".concat(r.width)),o||t.setAttribute("height","".concat(r.height)),t.setAttribute("href",a.toDataURL()))}}function P(t,n){var r=n.x1,i=n.y1,o=n.x2,a=n.y2,c=n.defX,s=void 0===c?0:c,l=n.defY,u=void 0===l?0:l,d=n.markerStart,p=n.markerEnd,h=n.markerStartOffset,f=n.markerEndOffset,v=0,m=0,g=0,y=0,b=0;d&&e.isDisplayObject(d)&&h&&(v=Math.cos(b=Math.atan2(a-i,o-r))*(h||0),m=Math.sin(b)*(h||0)),p&&e.isDisplayObject(p)&&f&&(g=Math.cos(b=Math.atan2(i-a,r-o))*(f||0),y=Math.sin(b)*(f||0)),t.setAttribute("x1","".concat(r-s+v)),t.setAttribute("y1","".concat(i-u+m)),t.setAttribute("x2","".concat(o-s+g)),t.setAttribute("y2","".concat(a-u+y))}function M(t,n){var r=n.path,i=n.defX,o=void 0===i?0:i,a=n.defY,s=void 0===a?0:a,l=n.markerStart,u=n.markerEnd,d=n.markerStartOffset,p=n.markerEndOffset,h=0,f=0,v=0,m=0,g=0;if(l&&e.isDisplayObject(l)&&d){var y=c(l.parentNode.getStartTangent(),2);h=Math.cos(g=Math.atan2((b=y[0])[1]-(E=y[1])[1],b[0]-E[0]))*(d||0),f=Math.sin(g)*(d||0)}if(u&&e.isDisplayObject(u)&&p){var b,E,A=c(u.parentNode.getEndTangent(),2);v=Math.cos(g=Math.atan2((b=A[0])[1]-(E=A[1])[1],b[0]-E[0]))*(p||0),m=Math.sin(g)*(p||0)}t.setAttribute("d",e.translatePathToString(r.absolutePath,o,s,h,f,v,m))}function k(t,n){var r=n.points.points,i=n.defX,o=void 0===i?0:i,a=n.defY,c=void 0===a?0:a,s=n.markerStart,l=n.markerStartOffset,u=n.markerEnd,d=n.markerEndOffset,p=r.length;if(r&&p>=2){var h=0,f=0,v=0,m=0,g=0;s&&e.isDisplayObject(s)&&l&&(h=Math.cos(g=Math.atan2(r[1][1]-r[0][1],r[1][0]-r[0][0]))*(l||0),f=Math.sin(g)*(l||0)),u&&e.isDisplayObject(u)&&d&&(v=Math.cos(g=Math.atan2(r[p-2][1]-r[p-1][1],r[p-2][0]-r[p-1][0]))*(d||0),m=Math.sin(g)*(d||0)),t.setAttribute("points",r.map((function(t,e){var n=0,r=0;return 0===e?(n=h,r=f):e===p-1&&(n=v,r=m),"".concat(t[0]-o+n,",").concat(t[1]-c+r)})).join(" "))}}function O(t,e){var n=e.radius,r=e.width,i=e.height;if(isFinite(r)&&isFinite(i)){var o="";if(n&&n.some((function(t){return 0!==t}))){var a=c(n.map((function(t){return m(t,0,Math.min(Math.abs(r)/2,Math.abs(i)/2))})),4),s=a[0],l=a[1],u=a[2],d=a[3],p=r>0?1:-1,h=i>0?1:-1,f=p+h!==0?1:0;o=[["M ".concat(p*s,",0")],["l ".concat(r-p*(s+l),",0")],["a ".concat(l,",").concat(l,",0,0,").concat(f,",").concat(p*l,",").concat(h*l)],["l 0,".concat(i-h*(l+u))],["a ".concat(u,",").concat(u,",0,0,").concat(f,",").concat(-p*u,",").concat(h*u)],["l ".concat(p*(u+d)-r,",0")],["a ".concat(d,",").concat(d,",0,0,").concat(f,",").concat(-p*d,",").concat(-h*d)],["l 0,".concat(h*(d+s)-i)],["a ".concat(s,",").concat(s,",0,0,").concat(f,",").concat(p*s,",").concat(-h*s)],["z"]].join(" ")}else o="M 0,0 l ".concat(r,",0 l 0,").concat(i," l").concat(-r," 0 z");t.setAttribute("d",o)}}function G(t,e){return(e||document).createElementNS("http://www.w3.org/2000/svg",t)}var L="g-filter-";function D(t,e,n,r,i){var o=L+n.entity,a=e.querySelectorAll("[name=".concat(o,"]"));if(a.length&&a.forEach((function(t){e.removeChild(t)})),0===i.length)null==r||r.removeAttribute("filter");else{var c=i.map((function(n,r){var i=n.name,a=n.params,c=G("filter",t);return c.setAttribute("filterUnits","userSpaceOnUse"),"blur"===i?function(t,e,n){var r=G("feGaussianBlur",t);r.setAttribute("in","SourceGraphic"),r.setAttribute("stdDeviation","".concat(n[0].value)),e.appendChild(r)}(t,c,a):"brightness"===i?function(t,e,n){var r=R(n[0]);V(t,e,{type:"linear",slope:r,intercept:0})}(t,c,a):"drop-shadow"===i?function(t,e,n){var r=n[0].value,i=n[1].value,o=n[2].value,a=n[3].formatted,c=G("feGaussianBlur",t);c.setAttribute("in","SourceAlpha"),c.setAttribute("stdDeviation","".concat(o)),e.appendChild(c);var s=G("feOffset",t);s.setAttribute("dx","".concat(r)),s.setAttribute("dy","".concat(i)),s.setAttribute("result","offsetblur"),e.appendChild(s);var l=G("feFlood",t);l.setAttribute("flood-color",a),e.appendChild(l);var u=G("feComposite",t);u.setAttribute("in2","offsetblur"),u.setAttribute("operator","in"),e.appendChild(u);var d=G("feMerge",t);e.appendChild(d);var p=G("feMergeNode",t),h=G("feMergeNode",t);h.setAttribute("in","SourceGraphic"),d.appendChild(p),d.appendChild(h)}(t,c,a):"contrast"===i?function(t,e,n){var r=R(n[0]);V(t,e,{type:"linear",slope:r,intercept:-.5*r+.5})}(t,c,a):"grayscale"===i?function(t,e,n){var r=R(n[0]);N(t,e,[.2126+.7874*(1-r),.7152-.7152*(1-r),.0722-.0722*(1-r),0,0,.2126-.2126*(1-r),.7152+.2848*(1-r),.0722-.0722*(1-r),0,0,.2126-.2126*(1-r),.7152-.7152*(1-r),.0722+.9278*(1-r),0,0,0,0,0,1,0])}(t,c,a):"sepia"===i?function(t,e,n){var r=R(n[0]);N(t,e,[.393+.607*(1-r),.769-.769*(1-r),.189-.189*(1-r),0,0,.349-.349*(1-r),.686+.314*(1-r),.168-.168*(1-r),0,0,.272-.272*(1-r),.534-.534*(1-r),.131+.869*(1-r),0,0,0,0,0,1,0])}(t,c,a):"saturate"===i?function(t,e,n){var r=R(n[0]),i=G("feColorMatrix",t);i.setAttribute("type","saturate"),i.setAttribute("values","".concat(r)),e.appendChild(i)}(t,c,a):"hue-rotate"===i?function(t,e,n){var r=G("feColorMatrix",t);r.setAttribute("type","hueRotate"),r.setAttribute("values","".concat(n[0].value)),e.appendChild(r)}(t,c,a):"invert"===i&&function(t,e,n){var r=R(n[0]);V(t,e,{type:"table",tableValues:"".concat(r," ").concat(1-r)})}(t,c,a),c.id="".concat(o,"-").concat(r),c.setAttribute("name",o),e.appendChild(c),c.id}));setTimeout((function(){null==r||r.setAttribute("filter",c.map((function(t){return"url(#".concat(t,")")})).join(" "))}))}}function R(t){return t.unit===e.UnitType.kPercentage?t.value/100:t.value}function V(t,e,n){var r=n.type,i=n.slope,o=n.intercept,a=n.tableValues,c=G("feComponentTransfer",t);[G("feFuncR",t),G("feFuncG",t),G("feFuncB",t)].forEach((function(t){t.setAttribute("type",r),"table"===r?t.setAttribute("tableValues","".concat(a)):(t.setAttribute("slope","".concat(i)),t.setAttribute("intercept","".concat(o))),c.appendChild(t)})),e.appendChild(c)}function N(t,e,n){var r=G("feColorMatrix",t);r.setAttribute("type","matrix"),r.setAttribute("values",n.join(" ")),e.appendChild(r)}var I="g-pattern-",$={},U=0;function _(t,n,r,i,o,a,c,s){if(!o)return"";if(!e.isCSSRGB(o)){if(e.isPattern(o)){var l=function(t,n,r,i,o,a){var c=H(i),s=n.querySelector("#".concat(c));if(!s){var l=i.image,u="";if(v(l)?u=l:e.isBrowser&&(l instanceof HTMLImageElement?u=l.src:l instanceof HTMLCanvasElement&&(u=l.toDataURL())),u){var d,p=G("image",t);p.setAttribute("href",u),o?d=o(u):e.isBrowser&&(d=new window.Image),u.match(/^data:/i)||(d.crossOrigin="Anonymous",p.setAttribute("crossorigin","anonymous")),d.src=u;var h=function(){var e=j(t,n,r,i,c,d.width,d.height);n.appendChild(e),e.appendChild(p),p.setAttribute("x","0"),p.setAttribute("y","0"),p.setAttribute("width","".concat(d.width)),p.setAttribute("height","".concat(d.height))};d.complete?h():d.onload=h}if("rect"===l.nodeName){var f=l.parsedStyle,m=j(t,n,l,i,c,f.width,f.height);l.forEach((function(e){a.createSVGDom(t,e,null);var n=e.elementSVG,r=e.getLocalTransform();a.applyTransform(n.$groupEl,r)})),m.appendChild(l.elementSVG.$groupEl)}}return c}(t,n,r,o,c,s);return i.style[a]="url(#".concat(l,")"),l}if(1===o.length){var u=F(t,r,n,i,o[0]);return null==i||i.setAttribute(a,"url(#".concat(u,")")),u}var d=function(t,e,n,r,i){var o=L+e.entity+"-gradient",a=n.querySelector("#".concat(o));a||((a=G("filter",t)).setAttribute("filterUnits","userSpaceOnUse"),a.setAttribute("x","0%"),a.setAttribute("y","0%"),a.setAttribute("width","100%"),a.setAttribute("height","100%"),a.id=o,n.appendChild(a));var c=0;i.forEach((function(i,s){var l=F(t,e,n,r,i),u=l+"_rect",d=G("rect",t);d.setAttribute("x","0"),d.setAttribute("y","0"),d.setAttribute("width","100%"),d.setAttribute("height","100%"),d.setAttribute("fill","url(#".concat(l,")")),d.id=u,n.appendChild(d);var p=G("feImage",t);if(p.setAttribute("href","#".concat(u)),p.setAttribute("result","".concat(o,"-").concat(s)),a.appendChild(p),s>0){var h=G("feBlend",t);h.setAttribute("in",1===s?"".concat(o,"-").concat(s-1):"".concat(o,"-blended-").concat(c-1)),h.setAttribute("in2","".concat(o,"-").concat(s)),h.setAttribute("result","".concat(o,"-blended-").concat(c++)),h.setAttribute("mode","multiply"),a.appendChild(h)}}));var s=G("feComposite",t);return s.setAttribute("in","".concat(o,"-blended-").concat(c)),s.setAttribute("in2","SourceGraphic"),s.setAttribute("operator","in"),a.appendChild(s),o}(t,r,n,i,o);return null==i||i.setAttribute("filter","url(#".concat(d,")")),null==i||i.setAttribute("fill","black"),d}return"currentColor"===r.style[a]?null==i||i.setAttribute(a,"currentColor"):null==i||i.setAttribute(a,o.isNone?"none":""+o),""}function H(t,n){void 0===n&&(n={});var r="";if(e.isCSSGradientValue(t)){var o=t.type;if(o===e.GradientType.LinearGradient||o===e.GradientType.RadialGradient){var a=i(i({},t.value),n),c=a.width,s=a.height,l=a.steps,u=a.angle,d=a.cx,p=a.cy,h=a.size;r="gradient-".concat(a.type,"-").concat((null==u?void 0:""+u)||0,"-").concat((null==d?void 0:""+d)||0,"-").concat((null==p?void 0:""+p)||0,"-").concat((null==h?void 0:""+h)||0,"-").concat(c,"-").concat(s,"-").concat(l.map((function(t){var e=t.color;return"".concat(t.offset).concat(e)})).join("-"))}}else e.isPattern(t)&&(r=v(t.image)?"pattern-".concat(t.image,"-").concat(t.repetition):"rect"===t.image.nodeName?"pattern-rect-".concat(t.image.entity):"pattern-".concat(U));return r&&($[r]||($[r]=I+"".concat(U++))),$[r]}function j(t,n,r,i,o,a,s){var l=i.repetition,u=i.transform,d=G("pattern",t);u&&d.setAttribute("patternTransform",function(t){return e.parseTransform(t).map((function(t){var e=t.t,n=t.d;if("translate"===e)return"translate(".concat(n[0].value," ").concat(n[1].value,")");if("translatex"===e)return"translate(".concat(n[0].value," 0)");if("translatey"===e)return"translate(0 ".concat(n[0].value,")");if("rotate"===e)return"rotate(".concat(n[0].value,")");if("scale"===e){var r=(null==n?void 0:n.map((function(t){return t.value})))||[1,1];return"scale(".concat(r[0],", ").concat(r[1],")")}if("scalex"===e)return r=(null==n?void 0:n.map((function(t){return t.value})))||[1],"scale(".concat(r[0],", 1)");if("scaley"===e)return r=(null==n?void 0:n.map((function(t){return t.value})))||[1],"scale(1, ".concat(r[0],")");if("skew"===e){var i=(null==n?void 0:n.map((function(t){return t.value})))||[0,0];return"skewX(".concat(i[0],") skewY(").concat(i[1],")")}if("skewx"===e)return i=(null==n?void 0:n.map((function(t){return t.value})))||[0],"skewX(".concat(i[0],")");if("skewy"===e)return i=(null==n?void 0:n.map((function(t){return t.value})))||[0],"skewY(".concat(i[0],")");if("matrix"===e){var o=c(n.map((function(t){return t.value})),6),a=o[1],s=o[2],l=o[3],u=o[4],d=o[5];return"matrix(".concat(o[0]," ").concat(a," ").concat(s," ").concat(l," ").concat(u," ").concat(d,")")}})).join(" ")}(u)),d.setAttribute("patternUnits","userSpaceOnUse"),d.id=o,n.appendChild(d),d.setAttribute("x","0"),d.setAttribute("y","0");var p=r.getGeometryBounds().halfExtents,h=a,f=s;return"repeat-x"===l?f=2*p[1]:"repeat-y"===l?h=2*p[0]:"no-repeat"===l&&(h=2*p[0],f=2*p[1]),d.setAttribute("width","".concat(h)),d.setAttribute("height","".concat(f)),d}function F(t,n,r,i,o){var a=n.getGeometryBounds(),c=a&&2*a.halfExtents[0]||0,s=a&&2*a.halfExtents[1]||0,l=H(o,{width:c,height:s}),u=r.querySelector("#".concat(l));if(!u){(u=G(o.type===e.GradientType.LinearGradient?"linearGradient":"radialGradient",t)).setAttribute("gradientUnits","userSpaceOnUse");var d="";o.value.steps.sort((function(t,e){return t.offset.value-e.offset.value})).forEach((function(t){var e=t.color;d+='<stop offset="'.concat(t.offset.value/100,'" stop-color="').concat(e,'"></stop>')})),u.innerHTML=d,u.id=l,r.appendChild(u)}if(o.type===e.GradientType.LinearGradient){var p=e.computeLinearGradient(c,s,o.value.angle),h=p.y1,f=p.x2,v=p.y2;u.setAttribute("x1","".concat(p.x1)),u.setAttribute("y1","".concat(h)),u.setAttribute("x2","".concat(f)),u.setAttribute("y2","".concat(v))}else{var m=o.value,g=e.computeRadialGradient(c,s,m.cx,m.cy,m.size),y=g.y,b=g.r;u.setAttribute("cx","".concat(g.x)),u.setAttribute("cy","".concat(y)),u.setAttribute("r","".concat(b))}return l}var X=/url\("?#(.*)\)/,B=function(){function t(t){this.context=t,this.gradientCache={}}return t.prototype.getDefElement=function(){return this.$def},t.prototype.init=function(){var t=this.context.config.document,e=this.context.contextService.getContext();this.$def=G("defs",t),e.appendChild(this.$def)},t.prototype.clear=function(t){var e=this;Object.keys(this.gradientCache).forEach((function(n){e.clearUnusedDefElement(e.gradientCache,n,t)}))},t.prototype.clearUnusedDefElement=function(t,e,n){if(t[e]&&1===t[e].size&&t[e].has(n)){var r=this.$def.querySelector("#".concat(e));r&&this.$def.removeChild(r)}},t.prototype.createOrUpdateGradientAndPattern=function(t,n,r,i,o){var a=this.context.config,c=a.document,s=a.createImage;if(n){var l=(e.isPattern(r)?n.style[i]:n.getAttribute(i)||"").match(X);l&&l.length>1&&this.clearUnusedDefElement(this.gradientCache,l[1].replace('"',""),t.entity);var u=_(c||document,this.$def,t,n,r,i,s,o);u&&(this.gradientCache[u]||(this.gradientCache[u]=new Set),this.gradientCache[u].add(t.entity))}},t.prototype.createOrUpdateShadow=function(t,e,n){!function(t,e,n,r,i){var o=n.parsedStyle,a=o.shadowType,c=o.shadowBlur,s=o.shadowColor,l=o.shadowOffsetX,u=o.shadowOffsetY,d=!p(s)&&c>0,h="g-filter-dropshadow-"+n.entity,f=e.querySelector("#".concat(h));if(f&&(f.getAttribute("data-type")===a&&d||(f.remove(),f=null)),d){if(null==r||r.setAttribute("filter","url(#".concat(h,")")),!f){if((f=G("filter",t)).setAttribute("data-type",a),"outer"===a)(C=G("feDropShadow",t)).setAttribute("dx","".concat((l||0)/2)),C.setAttribute("dy","".concat((u||0)/2)),C.setAttribute("stdDeviation","".concat((c||0)/4)),C.setAttribute("flood-color",""+s),f.appendChild(C);else if("inner"===a){var v=G("feComponentTransfer",t);v.setAttribute("in","SourceAlpha");var m=G("feFuncA",t);m.setAttribute("type","table"),m.setAttribute("tableValues","1 0"),v.appendChild(m),f.appendChild(v),(S=G("feGaussianBlur",t)).setAttribute("stdDeviation","".concat((c||0)/4)),f.appendChild(S),(x=G("feOffset",t)).setAttribute("dx","".concat((l||0)/2)),x.setAttribute("dy","".concat((u||0)/2)),x.setAttribute("result","offsetblur"),f.appendChild(x),(T=G("feFlood",t)).setAttribute("flood-color",""+s),T.setAttribute("result","color"),f.appendChild(T);var g=G("feComposite",t);g.setAttribute("in2","offsetblur"),g.setAttribute("operator","in"),f.appendChild(g);var y=G("feComposite",t);y.setAttribute("in2","SourceAlpha"),y.setAttribute("operator","in"),f.appendChild(y);var b=G("feMerge",t);f.appendChild(b);var E=G("feMergeNode",t);E.setAttribute("in","SourceGraphic");var A=G("feMergeNode",t);b.appendChild(E),b.appendChild(A)}return f.id=h,f.setAttribute("filterUnits","userSpaceOnUse"),void e.appendChild(f)}if("inner"===a){var S=f.children[1],x=f.children[2],T=f.children[3];"shadowColor"===i?T.setAttribute("flood-color",""+s):"shadowBlur"===i?S.setAttribute("stdDeviation","".concat((c||0)/4)):"shadowOffsetX"===i?x.setAttribute("dx","".concat((l||0)/2)):"shadowOffsetY"===i&&x.setAttribute("dy","".concat((u||0)/2))}else if("outer"===a){var C=f.children[0];"shadowColor"===i?C.setAttribute("flood-color",""+s):"shadowBlur"===i?C.setAttribute("stdDeviation","".concat((c||0)/4)):"shadowOffsetX"===i?C.setAttribute("dx","".concat((l||0)/2)):"shadowOffsetY"===i&&C.setAttribute("dy","".concat((u||0)/2))}}else null==r||r.removeAttribute("filter")}(this.context.config.document||document,this.$def,t,e,n)},t.prototype.createOrUpdateFilter=function(t,e,n){D(this.context.config.document||document,this.$def,t,e,n)},t}();function Y(t){return t.toFixed(6).replace(".000000","")}function W(t){return t.replace(/[&|<|>|"|']/g,(function(t){return"&"===t?"&amp;":"<"===t?"&lt;":">"===t?"&gt;":'"'===t?"&quot;":"&apos;"}))}var z,q,Q={opacity:"opacity",fillStyle:"fill",fill:"fill",fillRule:"fill-rule",fillOpacity:"fill-opacity",strokeStyle:"stroke",strokeOpacity:"stroke-opacity",stroke:"stroke",clipPath:"clip-path",textPath:"text-path",r:"r",rx:"rx",ry:"ry",width:"width",height:"height",lineCap:"stroke-linecap",lineJoin:"stroke-linejoin",lineWidth:"stroke-width",lineDash:"stroke-dasharray",lineDashOffset:"stroke-dashoffset",miterLimit:"stroke-miterlimit",font:"font",fontSize:"font-size",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",fontFamily:"font-family",letterSpacing:"letter-spacing",startArrow:"marker-start",endArrow:"marker-end",class:"class",id:"id",preserveAspectRatio:"preserveAspectRatio",visibility:"visibility",anchor:"anchor",shadowColor:"flood-color",shadowBlur:"stdDeviation",shadowOffsetX:"dx",shadowOffsetY:"dy",filter:"filter",innerHTML:"innerHTML",textAlign:"text-anchor",pointerEvents:"pointer-events"},J={textAlign:{inherit:"inherit",left:"left",start:"left",center:"middle",right:"end",end:"end"}},K={textAlign:"inherit",lineCap:"butt",lineJoin:"miter",lineWidth:"1px",opacity:"1",fillOpacity:"1",fillRule:"nonzero",strokeOpacity:"1",strokeWidth:"0",strokeMiterLimit:"4",letterSpacing:"0",fontSize:"inherit",fontFamily:"inherit",pointerEvents:"auto"},Z="g-svg",tt="clip-path-",et="text-path-",nt=function(){function t(t,e,n){this.pluginOptions=t,this.defElementManager=e,this.context=n,this.svgElementMap=new WeakMap,this.renderQueue=[],this.dirtyAttributes=new WeakMap,this.pendingReorderQueue=new Set,this.clipPathUseMap=new WeakMap}return t.prototype.apply=function(n){var r=this,i=n.renderingService,o=n.renderingContext;this.context=n,this.context.svgElementMap=this.svgElementMap;var a=o.root.ownerDocument.defaultView,c=this.context.config.document,s=function(t){var e=t.target;if(r.clipPathUseMap.get(e)){var n=r.defElementManager.getDefElement().querySelector("#".concat(r.getId(e)));n&&n.remove()}r.createSVGDom(c,e,r.$camera)},l=function(t){var e=t.target;r.defElementManager.clear(e.entity),r.clipPathUseMap.delete(e),r.removeSVGDom(e)},p=function(t){var e,n,i=t.parentNode,o=null===(n=null===(e=t.parentNode)||void 0===e?void 0:e.elementSVG)||void 0===n?void 0:n.$groupEl,a=((null==i?void 0:i.children)||[]).slice();o&&r.reorderChildren(c,o,a)},h=function(t){p(t.target)},f=function(t){var e=t.target;if(e.elementSVG){var n=t.attrName,i=r.dirtyAttributes.get(e);i||(r.dirtyAttributes.set(e,[]),i=r.dirtyAttributes.get(e)),i.push(n)}},v=function(t){var n,i=t.target,o=null===(n=i.elementSVG)||void 0===n?void 0:n.$el,a=i.parsedStyle,c=a.fill,s=a.stroke,l=a.clipPath;if(c&&!e.isCSSRGB(c)&&r.defElementManager.createOrUpdateGradientAndPattern(i,o,c,"fill",r),s&&!e.isCSSRGB(s)&&r.defElementManager.createOrUpdateGradientAndPattern(i,o,s,"stroke",r),l){var p=d(u(),i.getWorldTransform()),h=tt+l.entity+"-"+i.entity,f=r.defElementManager.getDefElement().querySelector("#".concat(h));f&&r.applyTransform(f,p)}};i.hooks.init.tap(t.tag,(function(){var t=r.context.config,n=t.background,i=t.document;r.defElementManager.init();var o=r.context.contextService.getContext();n&&(o.style.background=n),o.setAttribute("color-interpolation-filters","sRGB"),r.$camera=G("g",i),r.$camera.id="".concat(Z,"-camera"),r.applyTransform(r.$camera,r.context.camera.getOrthoMatrix()),o.appendChild(r.$camera),a.addEventListener(e.ElementEvent.MOUNTED,s),a.addEventListener(e.ElementEvent.UNMOUNTED,l),a.addEventListener(e.ElementEvent.REPARENT,h),a.addEventListener(e.ElementEvent.ATTR_MODIFIED,f),a.addEventListener(e.ElementEvent.BOUNDS_CHANGED,v)})),i.hooks.destroy.tap(t.tag,(function(){a.removeEventListener(e.ElementEvent.MOUNTED,s),a.removeEventListener(e.ElementEvent.UNMOUNTED,l),a.removeEventListener(e.ElementEvent.REPARENT,h),a.removeEventListener(e.ElementEvent.ATTR_MODIFIED,f),a.removeEventListener(e.ElementEvent.BOUNDS_CHANGED,v),U=0,$={}})),i.hooks.render.tap(t.tag,(function(t){r.renderQueue.push(t)})),i.hooks.beginFrame.tap(t.tag,(function(){var t=r.context.config.document;r.pendingReorderQueue.size&&(r.pendingReorderQueue.forEach((function(e){var n,i=((null==e?void 0:e.children)||[]).slice(),o=null===(n=null==e?void 0:e.elementSVG)||void 0===n?void 0:n.$groupEl;o&&r.reorderChildren(t||c,o,i||[])})),r.pendingReorderQueue.clear())})),i.hooks.endFrame.tap(t.tag,(function(){o.renderReasons.has(e.RenderReason.CAMERA_CHANGED)&&r.applyTransform(r.$camera,r.context.camera.getOrthoMatrix()),r.renderQueue.forEach((function(t){var e,n,i=null===(e=t.elementSVG)||void 0===e?void 0:e.$el,o=null===(n=t.elementSVG)||void 0===n?void 0:n.$groupEl;if(i&&o){var a=t.getLocalTransform();r.applyTransform(o,a);var c=r.clipPathUseMap.get(t);c&&c.length&&c.forEach((function(e){r.applyTransform(e,t.getWorldTransform())})),t.renderable.dirty=!1}var s=r.dirtyAttributes.get(t);s&&(s.forEach((function(e){"zIndex"===e?p(t):"increasedLineWidthForHitTesting"===e&&r.createOrUpdateHitArea(t,i,o),r.updateAttribute(t,[e])})),r.dirtyAttributes.delete(t))})),r.renderQueue=[]}))},t.prototype.getId=function(t){return t.id||"".concat(Z,"-").concat(t.entity)},t.prototype.reorderChildren=function(t,e,n){if(n.sort((function(t,e){return t.sortable.renderOrder-e.sortable.renderOrder})),n.length){var r=(t||document).createDocumentFragment();n.forEach((function(t){if(t.isConnected){var e=t.elementSVG.$groupEl;e&&r.appendChild(e)}})),e.appendChild(r)}},t.prototype.applyTransform=function(t,e){t.setAttribute("transform","matrix(".concat(Y(e[0]),",").concat(Y(e[1]),",").concat(Y(e[4]),",").concat(Y(e[5]),",").concat(Y(e[12]),",").concat(Y(e[13]),")"))},t.prototype.applyAttributes=function(t){var n=t.elementSVG,r=null==n?void 0:n.$el;if(r&&(null==n?void 0:n.$groupEl)){var i=t.nodeName,o=t.attributes;i!==e.Shape.HTML&&r.setAttribute("fill","none"),i===e.Shape.IMAGE&&r.setAttribute("preserveAspectRatio","none"),this.updateAttribute(t,Object.keys(o))}},t.prototype.updateAttribute=function(t,n){var r=this,i=this.context.enableCSSParsing,o=this.context.config.document,a=t.elementSVG,c=a.$el,s=a.$groupEl,l=a.$hitTestingEl,u=t.parsedStyle,d=t.computedStyle,h=t.nodeName;n.some((function(e){return r.context.SVGElementLifeCycleContribution.shouldUpdateElementAttribute(t,e)}))&&c&&[c,l].forEach((function(n){n&&(r.context.SVGElementLifeCycleContribution.updateElementAttribute(t,n,r.svgElementMap),t.nodeName!==e.Shape.TEXT&&r.updateAnchorWithTransform(t))})),n.forEach((function(n){var a,f,v=Q[n],m=i?d[n]:u[n],g=!p(m)&&""+m,y=(null===(a=J[n])||void 0===a?void 0:a[g])||g,b=u[n],E=v&&!!(null===(f=e.propertyMetadataCache[n])||void 0===f?void 0:f.inh);if(h===e.Shape.HTML)"fill"===n?c.style.background=""+b:"stroke"===n?(c.style["border-color"]=""+b,c.style["border-style"]="solid"):"lineWidth"===n?c.style["border-width"]="".concat(b||0,"px"):"lineDash"===n?c.style["border-style"]="dashed":"innerHTML"===n?r.createOrUpdateInnerHTML(o,c,b):"width"===n||"height"===n||"class"===n?c.setAttribute(n,""+b):"x"===n||"y"===n||p(t.style[n])||""===t.style[n]||(c.style[n]=t.style[n]);else{if(!v||(h===e.Shape.GROUP||t.isCustomElement)&&!i&&(E||"fill"===v||"stroke"===v))return;"fill"===n||"stroke"===n?r.defElementManager.createOrUpdateGradientAndPattern(t,c,b,v,r):i&&E?"unset"!==g&&g!==K[n]?null==s||s.setAttribute(v,y):null==s||s.removeAttribute(v):"clipPath"===n?r.createOrUpdateClipOrTextPath(o,b,t):"textPath"===n?r.createOrUpdateClipOrTextPath(o,b,t,!0):"shadowType"===n||"shadowColor"===n||"shadowBlur"===n||"shadowOffsetX"===n||"shadowOffsetY"===n?r.defElementManager.createOrUpdateShadow(t,c,n):"filter"===n?r.defElementManager.createOrUpdateFilter(t,c,b):"anchor"===n?h!==e.Shape.TEXT&&r.updateAnchorWithTransform(t):p(m)||[c,l].forEach((function(t){t&&v&&("unset"!==g&&g!==K[n]?t.setAttribute(v,y):t.removeAttribute(v))}))}}))},t.prototype.createSVGDom=function(t,n,r,i){var o;void 0===i&&(i=!1),n.elementSVG=new C;var a=n.elementSVG,c=this.context.SVGElementLifeCycleContribution.createElement(n,this.svgElementMap);if(c){var s=void 0;n.nodeName===e.Shape.HTML&&(n.parsedStyle.$el=c),this.pluginOptions.outputSVGElementId&&(c.id=this.getId(n)),this.pluginOptions.outputSVGElementName&&n.name&&c.setAttribute("name",n.name),!c.hasAttribute("data-wrapgroup")&&"g"===c.nodeName||i?s=c:(s=G("g",t)).appendChild(c),a.$el=c,a.$groupEl=s,this.applyAttributes(n),this.createOrUpdateHitArea(n,c,s);var l=r||n.parentNode&&(null===(o=n.parentNode.elementSVG)||void 0===o?void 0:o.$groupEl);l&&(l.appendChild(s),this.pendingReorderQueue.add(n.parentNode))}},t.prototype.removeSVGDom=function(t){var e,n=null===(e=t.elementSVG)||void 0===e?void 0:e.$groupEl;n&&n.parentNode&&(n.parentNode.removeChild(n),this.context.SVGElementLifeCycleContribution.destroyElement(t,n))},t.prototype.createOrUpdateHitArea=function(t,e,n){var r=t.elementSVG,i=r.$hitTestingEl,o=Number(t.parsedStyle.increasedLineWidthForHitTesting);if(o){if(!i){i=e.cloneNode(),["filter"].forEach((function(t){i.removeAttribute(t)}));var a="none"!==e.getAttribute("fill");i.setAttribute("fill",a?"transparent":"none"),i.setAttribute("stroke","transparent"),n.appendChild(i),r.$hitTestingEl=i,this.svgElementMap.set(i,t)}i.setAttribute("stroke-width","".concat(o+t.parsedStyle.lineWidth))}else i&&(n.removeChild(i),r.$hitTestingEl=null)},t.prototype.createOrUpdateInnerHTML=function(t,e,n){var r=(t||document).createElement("div");"string"==typeof n?r.innerHTML=n:r.appendChild(n),e.innerHTML="",e.appendChild(r)},t.prototype.createOrUpdateClipOrTextPath=function(t,e,n,r){void 0===r&&(r=!1);var i=n.elementSVG.$groupEl,o=r?"g":"clipPath",a=r?"text-path":"clip-path";if(e){var c=(r?et:tt)+e.entity+"-"+n.entity,s=this.defElementManager.getDefElement();if(!s.querySelector("#".concat(c))){var l=void 0;if(r)this.createSVGDom(t,e,null,!0),l=e.elementSVG.$el;else{if(!e.isConnected)s.querySelector("#".concat(this.getId(e)))||this.createSVGDom(t,e,s,!0);l=G(o,t);var p=G("use",t);p.setAttribute("href","#".concat(e.elementSVG.$el.id)),l.appendChild(p);var h=this.clipPathUseMap.get(e);h||(this.clipPathUseMap.set(e,[]),h=this.clipPathUseMap.get(e)),h.push(p),this.applyTransform(p,e.getWorldTransform());var f=d(u(),n.getWorldTransform());this.applyTransform(l,f)}this.pluginOptions.outputSVGElementId&&(l.id=c),s.appendChild(l)}this.applyAttributes(e),r||i.setAttribute(a,"url(#".concat(c,")"))}else r||i.removeAttribute(a)},t.prototype.updateAnchorWithTransform=function(t){var n,r,i=t.getGeometryBounds(),o=i&&2*i.halfExtents[0]||0,a=i&&2*i.halfExtents[1]||0,c=(t.parsedStyle||{}).anchor;[null===(n=t.elementSVG)||void 0===n?void 0:n.$el,null===(r=t.elementSVG)||void 0===r?void 0:r.$hitTestingEl].forEach((function(n){if(n){var r=-c[0]*o,i=-c[1]*a;0===r&&0===i||n.setAttribute("transform","translate(".concat(r,",").concat(i,")")),t.nodeName!==e.Shape.CIRCLE&&t.nodeName!==e.Shape.ELLIPSE||(n.setAttribute("cx","".concat(o/2)),n.setAttribute("cy","".concat(a/2)))}}))},t.tag="SVGRenderer",t}(),rt={top:"hanging",middle:"central",bottom:"text-after-edge",alphabetic:"alphabetic",ideographic:"ideographic",hanging:"hanging"};function it(t,e,n,r){var i=e.lineWidth,o=e.dx,a=e.dy,c=e.textPath,s=e.textPathSide,l=void 0===s?"left":s,u=e.textPathStartOffset,d=void 0===u?0:u,p=e.textDecorationLine,h=void 0===p?"":p,f=e.textDecorationColor,v=void 0===f?"":f,m=e.textDecorationStyle,g=void 0===m?"":m,y=e.metrics,b=e.textBaseline;r.enableCSSParsing||"alphabetic"!==b||(b="bottom"),t.setAttribute("dominant-baseline",rt[b]),t.setAttribute("paint-order","stroke");var E=y.lines,A=y.lineHeight,S=y.height,x=E.length,T="";if(0===o&&0===a||(T+="transform:translate(".concat(o,"px, ").concat(a,"px);")),h&&"none"!==h&&(T+="text-decoration:".concat(h," ").concat(g," ").concat(v,";")),T&&t.setAttribute("style",T),1===x){var C=W(E[0]);if(t.setAttribute("dx","".concat(i/2)),"bottom"!==b&&"top"!==b||(t.setAttribute("dominant-baseline",rt.middle),t.setAttribute("dy","bottom"===b?"-".concat(S/2,"px"):"".concat(S/2,"px"))),c){t.innerHTML="";var w=G("textPath",t.ownerDocument);w.setAttribute("href","#".concat(et+c.entity)),"left"!==l&&w.setAttribute("side",l),0!==d&&w.setAttribute("startOffset","".concat(d)),w.innerHTML=C,t.appendChild(w)}else t.innerHTML=C}else t.innerHTML=E.map((function(t,e){var n=0;return 0===e?"middle"===b?n=A/2-S/2:"top"===b||"hanging"===b?n=0:"bottom"!==b&&"alphabetic"!==b&&"ideographic"!==b||(n=-A*(x-1)):n=A,'<tspan x="0" dx="'.concat(i/2,'" dy="').concat(n,'">').concat(W(t),"</tspan>")})).join("")}var ot=((z={})[e.Shape.RECT]="path",z[e.Shape.CIRCLE]="circle",z[e.Shape.ELLIPSE]="ellipse",z[e.Shape.IMAGE]="image",z[e.Shape.GROUP]="g",z[e.Shape.LINE]="line",z[e.Shape.POLYLINE]="polyline",z[e.Shape.POLYGON]="polygon",z[e.Shape.TEXT]="text",z[e.Shape.PATH]="path",z[e.Shape.HTML]="foreignObject",z),at=((q={})[e.Shape.CIRCLE]=["r"],q[e.Shape.ELLIPSE]=["rx","ry"],q[e.Shape.RECT]=["width","height","radius"],q[e.Shape.IMAGE]=["img","width","height"],q[e.Shape.LINE]=["x1","y1","x2","y2","markerStart","markerEnd","markerStartOffset","markerEndOffset"],q[e.Shape.POLYLINE]=["points","markerStart","markerEnd","markerMid","markerStartOffset","markerEndOffset"],q[e.Shape.POLYGON]=["points","markerStart","markerEnd","markerMid","markerStartOffset","markerEndOffset"],q[e.Shape.PATH]=["path","markerStart","markerEnd","markerMid","markerStartOffset","markerEndOffset"],q[e.Shape.TEXT]=["text","font","fontSize","fontFamily","fontStyle","fontWeight","fontVariant","lineHeight","letterSpacing","wordWrap","wordWrapWidth","maxLines","leading","textBaseline","textAlign","textTransform","textOverflow","textPath","textPathSide","textPathStartOffset","textDecorationLine","textDecorationColor","textDecorationStyle","dx","dy"],q),ct=function(){function t(t,e){this.context=t,this.runtime=e}return t.prototype.createElement=function(t,e){var n=G(ot[t.nodeName]||"g",this.context.config.document||document);return e.set(n,t),n},t.prototype.destroyElement=function(t,e){},t.prototype.shouldUpdateElementAttribute=function(t,e){return(at[t.nodeName]||[]).indexOf(e)>-1},t.prototype.updateElementAttribute=function(t){var n=t.elementSVG.$el,r=t.parsedStyle;switch(t.nodeName){case e.Shape.IMAGE:w(n,r);break;case e.Shape.RECT:O(n,r);break;case e.Shape.LINE:P(n,r);break;case e.Shape.POLYGON:case e.Shape.POLYLINE:k(n,r);break;case e.Shape.PATH:M(n,r);break;case e.Shape.TEXT:it(n,r,0,this.runtime)}},t}(),st=function(t){function e(e){void 0===e&&(e={});var n=t.call(this)||this;return n.options=e,n.name="svg-renderer",n}return r(e,t),e.prototype.init=function(t){var e=this.options,n=e.outputSVGElementId,r=e.outputSVGElementName,i=new B(this.context),o=new ct(this.context,t);this.context.defaultElementLifeCycleContribution=o,this.context.SVGElementLifeCycleContribution=o;var a={outputSVGElementId:!!p(n)||!!n,outputSVGElementName:!!p(r)||!!r};this.addRenderingPlugin(new nt(a,i,this.context))},e.prototype.destroy=function(){this.removeAllRenderingPlugins(),delete this.context.defaultElementLifeCycleContribution,delete this.context.SVGElementLifeCycleContribution},e}(e.AbstractRendererPlugin),lt=Object.freeze({__proto__:null,CLIP_PATH_PREFIX:tt,DEFAULT_VALUE_MAP:K,DefaultElementLifeCycleContribution:ct,ElementSVG:C,G_SVG_PREFIX:Z,Plugin:st,SHAPE2TAGS:ot,SHAPE_UPDATE_DEPS:at,SVGRendererPlugin:nt,SVG_ATTR_MAP:Q,TEXT_PATH_PREFIX:et,createSVGElement:G,updateImageElementAttribute:w,updateLineElementAttribute:P,updatePathElementAttribute:M,updatePolylineElementAttribute:k,updateRectElementAttribute:O,updateTextElementAttribute:it}),ut="object"==typeof performance&&performance.now?performance:Date,dt=function(t,e){var n=e.x-t.x,r=e.y-t.y;return Math.abs(n)>Math.abs(r)?n>0?"right":"left":r>0?"down":"up"},pt=function(t,e){var n=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return Math.sqrt(n*n+r*r)},ht=function(){function t(t){var e=this;this.options=t,this.evCache=[],this.startPoints=[],this.processEvent={},this.throttleTimer=0,this.emitThrottles=[],this._start=function(t,n){var r;e.reset(),e.startTime=ut.now();var i=e.evCache,o=e.startPoints;if(t){var a=t.pointerId,l=t.x,u=t.y,d=i.findIndex((function(t){return a===t.pointerId}));-1!==d&&i.splice(d,1),i.push({pointerId:a,x:l,y:u,ev:t});for(var p=s([],c((null===(r=t.nativeEvent)||void 0===r?void 0:r.touches)||[]),!1),h=function(t){if(p.find((function(e){return i[t].pointerId===e.identifier})))return"continue";i.splice(t,1)},f=i.length-1;f>-1;f--)h(f)}o.length=i.length;for(f=0;i.length>f;f++){var v=i[f];o[f]={x:l=v.x,y:u=v.y}}if(1!==o.length){var m,g;e.startDistance=pt(o[0],o[1]),e.center={x:(m=o[0]).x+((g=o[1]).x-m.x)/2,y:m.y+(g.y-m.y)/2}}else{var y=i[0].ev;e.pressTimeout=setTimeout((function(){var t="press",r="none";y.direction=r,y.deltaX=0,y.deltaY=0,y.points=o,e.emitStart(t,y,n),y.type=t,n.dispatchEvent(y),e.eventType=t,e.direction=r,e.movingTarget=n}),250)}},this._move=function(t,n){e.clearPressTimeout();var r=e.startPoints,i=e.evCache;if(r.length){for(var o=t.x,a=t.y,c=t.pointerId,s=0,l=i.length;l>s;s++)if(c===i[s].pointerId){i[s]={pointerId:c,x:o,y:a,ev:t};break}var u={x:o,y:a},d=i.map((function(t){return{x:t.x,y:t.y}})),p=ut.now();if(e.prevMoveTime=e.lastMoveTime,e.prevMovePoint=e.lastMovePoint,e.lastMoveTime=p,e.lastMovePoint=u,1===r.length){var h=r[0],f=o-h.x,v=a-h.y,m=e.direction||dt(h,u);e.direction=m;var g=e.getEventType(u,n,t);return t.direction=m,t.deltaX=f,t.deltaY=v,t.points=d,e.emitStart(g,t,n),t.type=g,void e.refreshAndGetTarget(n).dispatchEvent(t)}var y=e.startDistance,b=pt(d[0],d[1]);t.zoom=b/y,t.center=e.center,t.points=d,e.emitStart("pinch",t,n),e._throttleEmit("pinch",t,n)}},this._end=function(t,n){var r=e.evCache,i=e.startPoints,o=r.map((function(t){return{x:t.x,y:t.y}}));if(t.points=o,e.emitEnd(t,e.refreshAndGetTarget(n)),1===r.length){var a=ut.now(),c=e.lastMoveTime;if(100>a-c){var s=c-(e.prevMoveTime||e.startTime);if(s>0){var l=e.prevMovePoint||i[0],u=e.lastMovePoint||i[0],d=pt(l,u)/s;d>.3&&(t.velocity=d,t.direction=dt(l,u),t.type="swipe",n.dispatchEvent(t))}}}for(var p=0,h=r.length;h>p;p++)if(r[p].pointerId===t.pointerId){r.splice(p,1),i.splice(p,1);break}e.reset(),r.length>0&&e._start(void 0,n)},this._cancel=function(t,n){var r=e.evCache.map((function(t){return{x:t.x,y:t.y}}));t.points=r,e.emitEnd(t,e.refreshAndGetTarget(n)),e.evCache=[],e.reset()}}return t.prototype.apply=function(e){var n=this,r=e.renderingService,i=e.renderingContext.root.ownerDocument,o=i.defaultView;this.canvas=o;var a=function(t){return t===i&&n.options.isDocumentGestureEnabled?i:t},c=function(t){var e=a(t.target);e&&n._move(t,e)},s=function(t){var e=a(t.target);e&&n._start(t,e)},l=function(t){var e=a(t.target);e&&n._end(t,e)},u=function(t){var e=a(t.target);e&&n._cancel(t,e)},d=function(t){var e=a(t.target);e&&n._end(t,e)};r.hooks.init.tap(t.tag,(function(){o.addEventListener("pointermove",c),o.addEventListener("pointerdown",s),o.addEventListener("pointerup",l),o.addEventListener("pointercancel",u),o.addEventListener("pointerupoutside",d)})),r.hooks.destroy.tap(t.tag,(function(){o.removeEventListener("pointermove",c),o.removeEventListener("pointerdown",s),o.removeEventListener("pointerup",l),o.removeEventListener("pointercancel",u),o.removeEventListener("pointerupoutside",d)}))},t.prototype.getEventType=function(t,e,n){var r,i=this,o=i.eventType,a=i.startTime,c=i.startPoints;if(o)return o;(this.movingTarget=e,this.isPanListenerInPath=n.path.some((function(t){var e,n;return!!(null===(n=null===(e=t.emitter)||void 0===e?void 0:e.eventNames())||void 0===n?void 0:n.includes("pan"))})),this.isPanListenerInPath)?r=ut.now()-a>250&&10>pt(c[0],t)?"press":"pan":r="press";return this.eventType=r,r},t.prototype.enable=function(t){this.processEvent[t]=!0},t.prototype.isProcess=function(t){return this.processEvent[t]},t.prototype.emitStart=function(t,e,n){this.isProcess(t)||(this.enable(t),e.type="".concat(t,"start"),n.dispatchEvent(e))},t.prototype._throttleEmit=function(t,e,n){var r=this;this.pushEvent(t,e);var i=this,o=i.emitThrottles,a=i.processEvent;i.throttleTimer||(this.throttleTimer=this.canvas.requestAnimationFrame((function(){for(var t=0,e=o.length;e>t;t++){var i=o[t],c=i.type,s=i.ev;a[c]&&(s.type=c,n.dispatchEvent(s))}r.throttleTimer=0,r.emitThrottles.length=0})))},t.prototype.emitEnd=function(t,e){var n=this.processEvent;Object.keys(n).forEach((function(r){t.type="".concat(r,"end"),e.dispatchEvent(t),delete n[r]}))},t.prototype.pushEvent=function(t,e){for(var n=this.emitThrottles,r={type:t,ev:e},i=0,o=n.length;o>i;i++)if(n[i].type===t)return void n.splice(i,1,r);n.push(r)},t.prototype.clearPressTimeout=function(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)},t.prototype.refreshAndGetTarget=function(t){return this.movingTarget?(this.movingTarget&&!this.movingTarget.isConnected&&(this.movingTarget=t),this.movingTarget):t},t.prototype.reset=function(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null,this.movingTarget=null,this.isPanListenerInPath=null},t.tag="Gesture",t}(),ft=function(t){function e(e){void 0===e&&(e={});var n=t.call(this)||this;return n.options=e,n.name="gesture",n}return r(e,t),e.prototype.init=function(){this.addRenderingPlugin(new ht(i({isDocumentGestureEnabled:!1},this.options)))},e.prototype.destroy=function(){this.removeAllRenderingPlugins()},e}(e.AbstractRendererPlugin),vt=function(){function t(t){this.canvasConfig=t.config}return t.prototype.init=function(){return o(this,void 0,void 0,(function(){var t,e,n,r,i;return a(this,(function(o){return n=(t=this.canvasConfig).document,this.$container=v(e=t.container)?(n||document).getElementById(e):e,this.$container&&(this.$container.style.position||(this.$container.style.position="relative"),(r=G("svg",n)).setAttribute("width","".concat(this.canvasConfig.width)),r.setAttribute("height","".concat(this.canvasConfig.height)),this.$container.appendChild(r),this.$namespace=r),i=window.devicePixelRatio||1,this.dpr=i=1>i?1:Math.ceil(i),[2]}))}))},t.prototype.getDomElement=function(){return this.$namespace},t.prototype.getContext=function(){return this.$namespace},t.prototype.getDPR=function(){return this.dpr},t.prototype.getBoundingClientRect=function(){var t;return null===(t=this.$namespace)||void 0===t?void 0:t.getBoundingClientRect()},t.prototype.destroy=function(){this.$container&&this.$namespace&&this.$namespace.parentNode&&this.$container.removeChild(this.$namespace)},t.prototype.resize=function(t,e){this.$namespace&&(this.$namespace.setAttribute("width","".concat(t)),this.$namespace.setAttribute("height","".concat(e)))},t.prototype.applyCursorStyle=function(t){this.$container&&(this.$container.style.cursor=t)},t.prototype.toDataURL=function(t){return o(this,void 0,void 0,(function(){var t,e,n;return a(this,(function(r){return t=this.$namespace.cloneNode(!0),e=document.implementation.createDocumentType("svg","-//W3C//DTD SVG 1.1//EN","http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"),(n=document.implementation.createDocument("http://www.w3.org/2000/svg","svg",e)).replaceChild(t,n.documentElement),[2,"data:image/svg+xml;charset=utf8,".concat(encodeURIComponent((new XMLSerializer).serializeToString(n)))]}))}))},t}(),mt=function(t){function e(){var e=t.apply(this,s([],c(arguments),!1))||this;return e.name="mobile-svg-context-register",e}return r(e,t),e.prototype.init=function(){this.context.ContextService=vt},e.prototype.destroy=function(){delete this.context.ContextService},e}(e.AbstractRendererPlugin),gt=function(t){function e(e){var n=t.call(this,e)||this;return n.registerPlugin(new mt),n.registerPlugin(new st),n.registerPlugin(new E),n.registerPlugin(new x),n.registerPlugin(new y({isDocumentDraggable:!!p(null==e?void 0:e.isDocumentDraggable)||e.isDocumentDraggable,isDocumentDroppable:!!p(null==e?void 0:e.isDocumentDroppable)||e.isDocumentDroppable,dragstartDistanceThreshold:p(null==e?void 0:e.dragstartDistanceThreshold)?10:e.dragstartDistanceThreshold,dragstartTimeThreshold:p(null==e?void 0:e.dragstartTimeThreshold)?50:e.dragstartTimeThreshold})),n.registerPlugin(new ft({isDocumentGestureEnabled:!0})),n}return r(e,t),e}(e.AbstractRenderer);t.MobileInteraction=A,t.Renderer=gt,t.SVGPicker=T,t.SVGRenderer=lt}));
//# sourceMappingURL=index.umd.min.js.map
