{"version":3,"file":"index.umd.min.js","sources":["../../../node_modules/.pnpm/node_modules/tslib/tslib.es6.js","../../../node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/common.js","../../../node_modules/.pnpm/gl-matrix@3.4.3/node_modules/gl-matrix/esm/mat4.js","../../../node_modules/.pnpm/@antv+util@3.3.4/node_modules/@antv/util/esm/lodash/is-nil.js","../../../node_modules/.pnpm/@antv+util@3.3.4/node_modules/@antv/util/esm/lodash/is-type.js","../../../node_modules/.pnpm/@antv+util@3.3.4/node_modules/@antv/util/esm/lodash/is-string.js","../../../node_modules/.pnpm/@antv+util@3.3.4/node_modules/@antv/util/esm/lodash/clamp.js","../../g-plugin-dragndrop/dist/index.esm.js","../../../node_modules/.pnpm/@antv+util@3.3.4/node_modules/@antv/util/esm/path/util/distance-square-root.js","../../g-plugin-mobile-interaction/dist/index.esm.js","../../g-plugin-svg-picker/dist/index.esm.js","../../g-plugin-svg-renderer/dist/index.esm.js","../../g-plugin-gesture/dist/index.esm.js","../src/packages/g-mobile-svg/src/SVGContextService.ts","../src/packages/g-mobile-svg/src/ContextRegisterPlugin.ts","../src/packages/g-mobile-svg/src/index.ts"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport default {\r\n    __extends,\r\n    __assign,\r\n    __rest,\r\n    __decorate,\r\n    __param,\r\n    __metadata,\r\n    __awaiter,\r\n    __generator,\r\n    __createBinding,\r\n    __exportStar,\r\n    __values,\r\n    __read,\r\n    __spread,\r\n    __spreadArrays,\r\n    __spreadArray,\r\n    __await,\r\n    __asyncGenerator,\r\n    __asyncDelegator,\r\n    __asyncValues,\r\n    __makeTemplateObject,\r\n    __importStar,\r\n    __importDefault,\r\n    __classPrivateFieldGet,\r\n    __classPrivateFieldSet,\r\n    __classPrivateFieldIn,\r\n};\r\n","/**\n * Common utilities\n * @module glMatrix\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion paramter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     mat4.translate(dest, origin);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *     mat4.translate(dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\n\nexport var perspective = perspectiveNO;\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\n\nexport var ortho = orthoNO;\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\n\nexport var sub = subtract;","// isFinite,\nvar isNil = function (value) {\n    /**\n     * isNil(null) => true\n     * isNil() => true\n     */\n    return value === null || value === undefined;\n};\nexport default isNil;\n//# sourceMappingURL=is-nil.js.map","var toString = {}.toString;\nvar isType = function (value, type) { return toString.call(value) === '[object ' + type + ']'; };\nexport default isType;\n//# sourceMappingURL=is-type.js.map","import isType from './is-type';\nexport default (function (str) {\n    return isType(str, 'String');\n});\n//# sourceMappingURL=is-string.js.map","var clamp = function (a, min, max) {\n    if (a < min) {\n        return min;\n    }\n    else if (a > max) {\n        return max;\n    }\n    return a;\n};\nexport default clamp;\n//# sourceMappingURL=clamp.js.map","import { __awaiter, __generator, __extends, __assign } from 'tslib';\nimport { AbstractRendererPlugin } from '@antv/g-lite';\nimport { distanceSquareRoot } from '@antv/util';\n\nvar DragndropPlugin = /** @class */ (function () {\n    function DragndropPlugin(dragndropPluginOptions) {\n        this.dragndropPluginOptions = dragndropPluginOptions;\n    }\n    DragndropPlugin.prototype.apply = function (context) {\n        var _this = this;\n        var renderingService = context.renderingService, renderingContext = context.renderingContext;\n        var document = renderingContext.root.ownerDocument;\n        // TODO: should we add an option like `draggable` to Canvas\n        var canvas = document.defaultView;\n        var handlePointerdown = function (event) {\n            var target = event.target;\n            var isDocument = target === document;\n            var draggableEventTarget = isDocument && _this.dragndropPluginOptions.isDocumentDraggable\n                ? document\n                : target.closest && target.closest('[draggable=true]');\n            // `draggable` may be set on ancestor nodes:\n            // @see https://github.com/antvis/G/issues/1088\n            if (draggableEventTarget) {\n                // delay triggering dragstart event\n                var dragstartTriggered_1 = false;\n                var dragstartTimeStamp_1 = event.timeStamp;\n                var dragstartClientCoordinates_1 = [\n                    event.clientX,\n                    event.clientY,\n                ];\n                var currentDroppable_1 = null;\n                var lastDragClientCoordinates_1 = [event.clientX, event.clientY];\n                // @ts-ignore\n                // eslint-disable-next-line no-inner-declarations\n                var handlePointermove_1 = function (event) { return __awaiter(_this, void 0, void 0, function () {\n                    var timeElapsed, distanceMoved, point, elementsBelow, elementBelow, droppableBelow;\n                    return __generator(this, function (_a) {\n                        switch (_a.label) {\n                            case 0:\n                                if (!dragstartTriggered_1) {\n                                    timeElapsed = event.timeStamp - dragstartTimeStamp_1;\n                                    distanceMoved = distanceSquareRoot([event.clientX, event.clientY], dragstartClientCoordinates_1);\n                                    // check thresholds\n                                    if (timeElapsed <=\n                                        this.dragndropPluginOptions.dragstartTimeThreshold ||\n                                        distanceMoved <=\n                                            this.dragndropPluginOptions.dragstartDistanceThreshold) {\n                                        return [2 /*return*/];\n                                    }\n                                    // @see https://developer.mozilla.org/zh-CN/docs/Web/API/Document/dragstart_event\n                                    event.type = 'dragstart';\n                                    draggableEventTarget.dispatchEvent(event);\n                                    dragstartTriggered_1 = true;\n                                }\n                                // @see https://developer.mozilla.org/zh-CN/docs/Web/API/Document/drag_event\n                                event.type = 'drag';\n                                // @ts-ignore\n                                event.dx = event.clientX - lastDragClientCoordinates_1[0];\n                                // @ts-ignore\n                                event.dy = event.clientY - lastDragClientCoordinates_1[1];\n                                draggableEventTarget.dispatchEvent(event);\n                                lastDragClientCoordinates_1 = [event.clientX, event.clientY];\n                                if (!!isDocument) return [3 /*break*/, 2];\n                                point = this.dragndropPluginOptions.overlap === 'pointer'\n                                    ? [event.canvasX, event.canvasY]\n                                    : target.getBounds().center;\n                                return [4 /*yield*/, document.elementsFromPoint(point[0], point[1])];\n                            case 1:\n                                elementsBelow = _a.sent();\n                                elementBelow = elementsBelow[elementsBelow.indexOf(target) + 1];\n                                droppableBelow = (elementBelow === null || elementBelow === void 0 ? void 0 : elementBelow.closest('[droppable=true]')) ||\n                                    (this.dragndropPluginOptions.isDocumentDroppable\n                                        ? document\n                                        : null);\n                                if (currentDroppable_1 !== droppableBelow) {\n                                    if (currentDroppable_1) {\n                                        // null when we were not over a droppable before this event\n                                        // @see https://developer.mozilla.org/zh-CN/docs/Web/API/Document/dragleave_event\n                                        event.type = 'dragleave';\n                                        event.target = currentDroppable_1;\n                                        currentDroppable_1.dispatchEvent(event);\n                                    }\n                                    if (droppableBelow) {\n                                        // @see https://developer.mozilla.org/zh-CN/docs/Web/API/Document/dragleave_event\n                                        event.type = 'dragenter';\n                                        event.target = droppableBelow;\n                                        droppableBelow.dispatchEvent(event);\n                                    }\n                                    currentDroppable_1 = droppableBelow;\n                                    if (currentDroppable_1) {\n                                        // null if we're not coming over a droppable now\n                                        // @see https://developer.mozilla.org/zh-CN/docs/Web/API/Document/dragover_event\n                                        event.type = 'dragover';\n                                        event.target = currentDroppable_1;\n                                        currentDroppable_1.dispatchEvent(event);\n                                    }\n                                }\n                                _a.label = 2;\n                            case 2: return [2 /*return*/];\n                        }\n                    });\n                }); };\n                canvas.addEventListener('pointermove', handlePointermove_1);\n                var stopDragging = function (originalPointerUpEvent) {\n                    if (dragstartTriggered_1) {\n                        // prevent click event being triggerd\n                        // @see https://github.com/antvis/G/issues/1091\n                        originalPointerUpEvent.detail = {\n                            preventClick: true,\n                        };\n                        // clone event first\n                        var event_1 = originalPointerUpEvent.clone();\n                        // drop should fire before dragend\n                        // @see https://javascript.tutorialink.com/is-there-a-defined-ordering-between-dragend-and-drop-events/\n                        if (currentDroppable_1) {\n                            // @see https://developer.mozilla.org/zh-CN/docs/Web/API/Document/drop_event\n                            event_1.type = 'drop';\n                            event_1.target = currentDroppable_1;\n                            currentDroppable_1.dispatchEvent(event_1);\n                        }\n                        // @see https://developer.mozilla.org/zh-CN/docs/Web/API/Document/dragend_event\n                        event_1.type = 'dragend';\n                        draggableEventTarget.dispatchEvent(event_1);\n                        dragstartTriggered_1 = false;\n                    }\n                    canvas.removeEventListener('pointermove', handlePointermove_1);\n                };\n                target.addEventListener('pointerup', stopDragging, { once: true });\n                target.addEventListener('pointerupoutside', stopDragging, {\n                    once: true,\n                });\n            }\n        };\n        renderingService.hooks.init.tap(DragndropPlugin.tag, function () {\n            canvas.addEventListener('pointerdown', handlePointerdown);\n        });\n        renderingService.hooks.destroy.tap(DragndropPlugin.tag, function () {\n            canvas.removeEventListener('pointerdown', handlePointerdown);\n        });\n    };\n    DragndropPlugin.tag = 'Dragndrop';\n    return DragndropPlugin;\n}());\n\nvar Plugin = /** @class */ (function (_super) {\n    __extends(Plugin, _super);\n    function Plugin(options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this) || this;\n        _this.options = options;\n        _this.name = 'dragndrop';\n        return _this;\n    }\n    Plugin.prototype.init = function () {\n        this.addRenderingPlugin(new DragndropPlugin(__assign({ overlap: 'pointer', isDocumentDraggable: false, isDocumentDroppable: false, dragstartDistanceThreshold: 0, dragstartTimeThreshold: 0 }, this.options)));\n    };\n    Plugin.prototype.destroy = function () {\n        this.removeAllRenderingPlugins();\n    };\n    Plugin.prototype.setOptions = function (options) {\n        Object.assign(this.plugins[0].dragndropPluginOptions, options);\n    };\n    return Plugin;\n}(AbstractRendererPlugin));\n\nexport { Plugin };\n//# sourceMappingURL=index.esm.js.map\n","export function distanceSquareRoot(a, b) {\n    return Math.sqrt((a[0] - b[0]) * (a[0] - b[0]) + (a[1] - b[1]) * (a[1] - b[1]));\n}\n//# sourceMappingURL=distance-square-root.js.map","import { __extends, __spreadArray, __read } from 'tslib';\nimport { AbstractRendererPlugin } from '@antv/g-lite';\n\n/**\n * listen to mouse/touch/pointer events on DOM wrapper, trigger pointer events\n */\nvar MobileInteractionPlugin = /** @class */ (function () {\n    function MobileInteractionPlugin() {\n    }\n    MobileInteractionPlugin.prototype.apply = function (context) {\n        var renderingService = context.renderingService, contextService = context.contextService, config = context.config;\n        // 获取小程序上下文\n        var canvasEl = contextService.getDomElement();\n        var onPointerDown = function (ev) {\n            renderingService.hooks.pointerDown.call(ev);\n        };\n        var onPointerUp = function (ev) {\n            renderingService.hooks.pointerUp.call(ev);\n        };\n        var onPointerMove = function (ev) {\n            // 触发 G 定义的标准 pointerMove 事件\n            renderingService.hooks.pointerMove.call(ev);\n        };\n        var onPointerOver = function (ev) {\n            renderingService.hooks.pointerOver.call(ev);\n        };\n        var onPointerOut = function (ev) {\n            renderingService.hooks.pointerOut.call(ev);\n        };\n        var onClick = function (ev) {\n            renderingService.hooks.click.call(ev);\n        };\n        var onPointerCancel = function (ev) {\n            renderingService.hooks.pointerCancel.call(ev);\n        };\n        renderingService.hooks.init.tap(MobileInteractionPlugin.tag, function () {\n            // 基于小程序上下文的事件监听方式，绑定事件监听，可以参考下面基于 DOM 的方式\n            canvasEl.addEventListener('touchstart', onPointerDown, true);\n            canvasEl.addEventListener('touchend', onPointerUp, true);\n            canvasEl.addEventListener('touchmove', onPointerMove, true);\n            canvasEl.addEventListener('touchcancel', onPointerCancel, true);\n            // FIXME: 这里不应该只在 canvasEl 上监听 mousemove 和 mouseup，而应该在更高层级的节点上例如 document 监听。\n            // 否则无法判断是否移出了 canvasEl\n            // canvasEl.addEventListener('mousemove', onPointerMove, true);\n            // canvasEl.addEventListener('mousedown', onPointerDown, true);\n            canvasEl.addEventListener('mouseout', onPointerOut, true);\n            canvasEl.addEventListener('mouseover', onPointerOver, true);\n            // canvasEl.addEventListener('mouseup', onPointerUp, true);\n            if (config.useNativeClickEvent) {\n                canvasEl.addEventListener('click', onClick, true);\n            }\n        });\n        renderingService.hooks.destroy.tap(MobileInteractionPlugin.tag, function () {\n            // 基于小程序上下文的事件监听方式，移除事件监听\n            canvasEl.removeEventListener('touchstart', onPointerDown, true);\n            canvasEl.removeEventListener('touchend', onPointerUp, true);\n            canvasEl.removeEventListener('touchmove', onPointerMove, true);\n            canvasEl.removeEventListener('touchcancel', onPointerCancel, true);\n            // canvasEl.removeEventListener('mousemove', onPointerMove, true);\n            // canvasEl.removeEventListener('mousedown', onPointerDown, true);\n            canvasEl.removeEventListener('mouseout', onPointerOut, true);\n            canvasEl.removeEventListener('mouseover', onPointerOver, true);\n            // canvasEl.removeEventListener('mouseup', onPointerUp, true);\n            if (config.useNativeClickEvent) {\n                canvasEl.removeEventListener('click', onClick, true);\n            }\n        });\n    };\n    MobileInteractionPlugin.tag = 'MobileInteraction';\n    return MobileInteractionPlugin;\n}());\n\nvar Plugin = /** @class */ (function (_super) {\n    __extends(Plugin, _super);\n    function Plugin() {\n        var _this = _super.apply(this, __spreadArray([], __read(arguments), false)) || this;\n        _this.name = 'mobile-interaction';\n        return _this;\n    }\n    Plugin.prototype.init = function () {\n        this.addRenderingPlugin(new MobileInteractionPlugin());\n    };\n    Plugin.prototype.destroy = function () {\n        this.removeAllRenderingPlugins();\n    };\n    return Plugin;\n}(AbstractRendererPlugin));\n\nexport { Plugin };\n//# sourceMappingURL=index.esm.js.map\n","import { __awaiter, __generator, __values, __extends, __spreadArray, __read } from 'tslib';\nimport { AbstractRendererPlugin } from '@antv/g-lite';\n\n/**\n * pick shape(s) with Mouse/Touch event\n *\n * 1. find AABB with r-tree\n * 2. use elementFromPoint\n */\nvar SVGPickerPlugin = /** @class */ (function () {\n    function SVGPickerPlugin() {\n    }\n    SVGPickerPlugin.prototype.apply = function (context, runtime) {\n        var _this = this;\n        var doc = context.config.document, renderingService = context.renderingService, \n        // @ts-ignore\n        svgElementMap = context.svgElementMap;\n        renderingService.hooks.pick.tapPromise(SVGPickerPlugin.tag, function (result) { return __awaiter(_this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, this.pick(svgElementMap, doc, result)];\n            });\n        }); });\n        renderingService.hooks.pickSync.tap(SVGPickerPlugin.tag, function (result) {\n            return _this.pick(svgElementMap, doc, result);\n        });\n    };\n    SVGPickerPlugin.prototype.pick = function (svgElementMap, doc, result) {\n        var e_1, _a;\n        var topmost = result.topmost, _b = result.position, clientX = _b.clientX, clientY = _b.clientY;\n        try {\n            var targets = [];\n            try {\n                // @see https://developer.mozilla.org/zh-CN/docs/Web/API/Document/elementsFromPoint\n                for (var _c = __values((doc || document).elementsFromPoint(clientX, clientY)), _d = _c.next(); !_d.done; _d = _c.next()) {\n                    var element = _d.value;\n                    if (element.shadowRoot && element.shadowRoot !== doc) {\n                        return this.pick(svgElementMap, element.shadowRoot, result);\n                    }\n                    else {\n                        var target = svgElementMap.get(element);\n                        // don't need to account for `visibility` since DOM API already does\n                        if (target && target.isInteractive()) {\n                            targets.push(target);\n                            if (topmost) {\n                                result.picked = targets;\n                                return result;\n                            }\n                        }\n                    }\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n            result.picked = targets;\n        }\n        catch (e) {\n            result.picked = [];\n        }\n        return result;\n    };\n    SVGPickerPlugin.tag = 'SVGPicker';\n    return SVGPickerPlugin;\n}());\n\nvar Plugin = /** @class */ (function (_super) {\n    __extends(Plugin, _super);\n    function Plugin() {\n        var _this = _super.apply(this, __spreadArray([], __read(arguments), false)) || this;\n        _this.name = 'svg-picker';\n        return _this;\n    }\n    Plugin.prototype.init = function () {\n        this.addRenderingPlugin(new SVGPickerPlugin());\n    };\n    Plugin.prototype.destroy = function () {\n        this.removeAllRenderingPlugins();\n    };\n    return Plugin;\n}(AbstractRendererPlugin));\n\nexport { Plugin };\n//# sourceMappingURL=index.esm.js.map\n","import { __read, __assign, __extends } from 'tslib';\nimport { isDisplayObject, translatePathToString, UnitType, isCSSRGB, isPattern, isBrowser, GradientType, computeLinearGradient, computeRadialGradient, isCSSGradientValue, parseTransform, ElementEvent, RenderReason, Shape, propertyMetadataCache, AbstractRendererPlugin } from '@antv/g-lite';\nimport { isString, clamp, isNil } from '@antv/util';\nimport { mat4 } from 'gl-matrix';\n\nvar ElementSVG = /** @class */ (function () {\n    function ElementSVG() {\n    }\n    ElementSVG.tag = 'c-svg-element';\n    return ElementSVG;\n}());\n\nfunction updateImageElementAttribute($el, parsedStyle) {\n    var _a = parsedStyle.img, img = _a === void 0 ? '' : _a, width = parsedStyle.width, height = parsedStyle.height;\n    $el.setAttribute('x', '0');\n    $el.setAttribute('y', '0');\n    if (isString(img)) {\n        $el.setAttribute('href', img);\n    }\n    else if (img instanceof Image) {\n        if (!width) {\n            $el.setAttribute('width', \"\".concat(img.width));\n            // TODO: set renderable.boundsDirty\n            // this.attr('width', img.width);\n        }\n        if (!height) {\n            $el.setAttribute('height', \"\".concat(img.height));\n            // this.attr('height', img.height);\n        }\n        $el.setAttribute('href', img.src);\n    }\n    else if (\n    // @ts-ignore\n    img instanceof HTMLElement &&\n        isString(img.nodeName) &&\n        img.nodeName.toUpperCase() === 'CANVAS') {\n        $el.setAttribute('href', img.toDataURL());\n        // @ts-ignore\n    }\n    else if (img instanceof ImageData) {\n        var canvas = document.createElement('canvas');\n        // @ts-ignore\n        canvas.setAttribute('width', \"\".concat(img.width));\n        // @ts-ignore\n        canvas.setAttribute('height', \"\".concat(img.height));\n        var context = canvas.getContext('2d');\n        if (context) {\n            context.putImageData(img, 0, 0);\n            if (!width) {\n                // @ts-ignore\n                $el.setAttribute('width', \"\".concat(img.width));\n                // this.attr('width', img.width);\n            }\n            if (!height) {\n                // @ts-ignore\n                $el.setAttribute('height', \"\".concat(img.height));\n                // this.attr('height', img.height);\n            }\n            $el.setAttribute('href', canvas.toDataURL());\n        }\n    }\n}\n\nfunction updateLineElementAttribute($el, parsedStyle) {\n    var x1 = parsedStyle.x1, y1 = parsedStyle.y1, x2 = parsedStyle.x2, y2 = parsedStyle.y2, _a = parsedStyle.defX, defX = _a === void 0 ? 0 : _a, _b = parsedStyle.defY, defY = _b === void 0 ? 0 : _b, markerStart = parsedStyle.markerStart, markerEnd = parsedStyle.markerEnd, markerStartOffset = parsedStyle.markerStartOffset, markerEndOffset = parsedStyle.markerEndOffset;\n    var startOffsetX = 0;\n    var startOffsetY = 0;\n    var endOffsetX = 0;\n    var endOffsetY = 0;\n    var rad = 0;\n    var x;\n    var y;\n    if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n        x = x2 - x1;\n        y = y2 - y1;\n        rad = Math.atan2(y, x);\n        startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n        startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n    }\n    if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n        x = x1 - x2;\n        y = y1 - y2;\n        rad = Math.atan2(y, x);\n        endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n        endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n    }\n    // @see https://github.com/antvis/g/issues/1038\n    $el.setAttribute('x1', \"\".concat(x1 - defX + startOffsetX));\n    $el.setAttribute('y1', \"\".concat(y1 - defY + startOffsetY));\n    $el.setAttribute('x2', \"\".concat(x2 - defX + endOffsetX));\n    $el.setAttribute('y2', \"\".concat(y2 - defY + endOffsetY));\n}\n\nfunction updatePathElementAttribute($el, parsedStyle) {\n    var path = parsedStyle.path, _a = parsedStyle.defX, defX = _a === void 0 ? 0 : _a, _b = parsedStyle.defY, defY = _b === void 0 ? 0 : _b, markerStart = parsedStyle.markerStart, markerEnd = parsedStyle.markerEnd, markerStartOffset = parsedStyle.markerStartOffset, markerEndOffset = parsedStyle.markerEndOffset;\n    var startOffsetX = 0;\n    var startOffsetY = 0;\n    var endOffsetX = 0;\n    var endOffsetY = 0;\n    var rad = 0;\n    var x;\n    var y;\n    if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n        var _c = __read(markerStart.parentNode.getStartTangent(), 2), p1 = _c[0], p2 = _c[1];\n        x = p1[0] - p2[0];\n        y = p1[1] - p2[1];\n        rad = Math.atan2(y, x);\n        startOffsetX = Math.cos(rad) * (markerStartOffset || 0);\n        startOffsetY = Math.sin(rad) * (markerStartOffset || 0);\n    }\n    if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n        var _d = __read(markerEnd.parentNode.getEndTangent(), 2), p1 = _d[0], p2 = _d[1];\n        x = p1[0] - p2[0];\n        y = p1[1] - p2[1];\n        rad = Math.atan2(y, x);\n        endOffsetX = Math.cos(rad) * (markerEndOffset || 0);\n        endOffsetY = Math.sin(rad) * (markerEndOffset || 0);\n    }\n    $el.setAttribute('d', translatePathToString(path.absolutePath, defX, defY, startOffsetX, startOffsetY, endOffsetX, endOffsetY));\n}\n\nfunction updatePolylineElementAttribute($el, parsedStyle) {\n    var points = parsedStyle.points.points, _a = parsedStyle.defX, defX = _a === void 0 ? 0 : _a, _b = parsedStyle.defY, defY = _b === void 0 ? 0 : _b, markerStart = parsedStyle.markerStart, markerStartOffset = parsedStyle.markerStartOffset, markerEnd = parsedStyle.markerEnd, markerEndOffset = parsedStyle.markerEndOffset;\n    var length = points.length;\n    if (points && length >= 2) {\n        var startOffsetX_1 = 0;\n        var startOffsetY_1 = 0;\n        var endOffsetX_1 = 0;\n        var endOffsetY_1 = 0;\n        var rad = 0;\n        var x = void 0;\n        var y = void 0;\n        if (markerStart && isDisplayObject(markerStart) && markerStartOffset) {\n            x = points[1][0] - points[0][0];\n            y = points[1][1] - points[0][1];\n            rad = Math.atan2(y, x);\n            startOffsetX_1 = Math.cos(rad) * (markerStartOffset || 0);\n            startOffsetY_1 = Math.sin(rad) * (markerStartOffset || 0);\n        }\n        if (markerEnd && isDisplayObject(markerEnd) && markerEndOffset) {\n            x = points[length - 2][0] - points[length - 1][0];\n            y = points[length - 2][1] - points[length - 1][1];\n            rad = Math.atan2(y, x);\n            endOffsetX_1 = Math.cos(rad) * (markerEndOffset || 0);\n            endOffsetY_1 = Math.sin(rad) * (markerEndOffset || 0);\n        }\n        $el.setAttribute('points', points\n            .map(function (point, i) {\n            var offsetX = 0;\n            var offsetY = 0;\n            if (i === 0) {\n                offsetX = startOffsetX_1;\n                offsetY = startOffsetY_1;\n            }\n            else if (i === length - 1) {\n                offsetX = endOffsetX_1;\n                offsetY = endOffsetY_1;\n            }\n            return \"\".concat(point[0] - defX + offsetX, \",\").concat(point[1] - defY + offsetY);\n        })\n            .join(' '));\n    }\n}\n\nfunction updateRectElementAttribute($el, parsedStyle) {\n    var radius = parsedStyle.radius, width = parsedStyle.width, height = parsedStyle.height;\n    // CSSKeyword: auto\n    if (!isFinite(width) || !isFinite(height)) {\n        return;\n    }\n    var hasRadius = radius && radius.some(function (r) { return r !== 0; });\n    var d = '';\n    if (!hasRadius) {\n        d = \"M 0,0 l \".concat(width, \",0 l 0,\").concat(height, \" l\").concat(-width, \" 0 z\");\n    }\n    else {\n        var _a = __read(radius.map(function (r) {\n            return clamp(r, 0, Math.min(Math.abs(width) / 2, Math.abs(height) / 2));\n        }), 4), tlr = _a[0], trr = _a[1], brr = _a[2], blr = _a[3];\n        var signX = width > 0 ? 1 : -1;\n        var signY = height > 0 ? 1 : -1;\n        // sweep-flag @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Tutorial/Paths#arcs\n        var sweepFlag = signX + signY !== 0 ? 1 : 0;\n        d = [\n            [\"M \".concat(signX * tlr, \",0\")],\n            [\"l \".concat(width - signX * (tlr + trr), \",0\")],\n            [\"a \".concat(trr, \",\").concat(trr, \",0,0,\").concat(sweepFlag, \",\").concat(signX * trr, \",\").concat(signY * trr)],\n            [\"l 0,\".concat(height - signY * (trr + brr))],\n            [\"a \".concat(brr, \",\").concat(brr, \",0,0,\").concat(sweepFlag, \",\").concat(-signX * brr, \",\").concat(signY * brr)],\n            [\"l \".concat(signX * (brr + blr) - width, \",0\")],\n            [\"a \".concat(blr, \",\").concat(blr, \",0,0,\").concat(sweepFlag, \",\").concat(-signX * blr, \",\").concat(-signY * blr)],\n            [\"l 0,\".concat(signY * (blr + tlr) - height)],\n            [\"a \".concat(tlr, \",\").concat(tlr, \",0,0,\").concat(sweepFlag, \",\").concat(signX * tlr, \",\").concat(-signY * tlr)],\n            ['z'],\n        ].join(' ');\n    }\n    $el.setAttribute('d', d);\n}\n\nfunction createSVGElement(type, doc) {\n    return (doc || document).createElementNS('http://www.w3.org/2000/svg', type);\n}\n\nvar FILTER_PREFIX = 'g-filter-';\n/**\n * use SVG filters, eg. blur, brightness, contrast...\n * @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/filter\n */\nfunction createOrUpdateFilter(document, $def, object, $el, filters) {\n    // eg. filter=\"url(#f1) url(#f2)\"\n    var filterName = FILTER_PREFIX + object.entity;\n    var $existedFilters = $def.querySelectorAll(\"[name=\".concat(filterName, \"]\"));\n    if ($existedFilters.length) {\n        $existedFilters.forEach(function ($filter) {\n            $def.removeChild($filter);\n        });\n    }\n    if (filters.length === 0) {\n        // 'none'\n        $el === null || $el === void 0 ? void 0 : $el.removeAttribute('filter');\n    }\n    else {\n        var filterIds_1 = filters.map(function (_a, i) {\n            var name = _a.name, params = _a.params;\n            var $filter = createSVGElement('filter', document);\n            // @see https://github.com/antvis/g/issues/1025\n            $filter.setAttribute('filterUnits', 'userSpaceOnUse');\n            if (name === 'blur') {\n                createBlur(document, $filter, params);\n            }\n            else if (name === 'brightness') {\n                createBrightness(document, $filter, params);\n            }\n            else if (name === 'drop-shadow') {\n                createDropShadow(document, $filter, params);\n            }\n            else if (name === 'contrast') {\n                createContrast(document, $filter, params);\n            }\n            else if (name === 'grayscale') {\n                createGrayscale(document, $filter, params);\n            }\n            else if (name === 'sepia') {\n                createSepia(document, $filter, params);\n            }\n            else if (name === 'saturate') {\n                createSaturate(document, $filter, params);\n            }\n            else if (name === 'hue-rotate') {\n                createHueRotate(document, $filter, params);\n            }\n            else if (name === 'invert') {\n                createInvert(document, $filter, params);\n            }\n            $filter.id = \"\".concat(filterName, \"-\").concat(i);\n            $filter.setAttribute('name', filterName);\n            $def.appendChild($filter);\n            return $filter.id;\n        });\n        // @see https://github.com/antvis/G/issues/1114\n        setTimeout(function () {\n            $el === null || $el === void 0 ? void 0 : $el.setAttribute('filter', filterIds_1.map(function (filterId) { return \"url(#\".concat(filterId, \")\"); }).join(' '));\n        });\n    }\n}\nfunction convertToAbsoluteValue(param) {\n    return param.unit === UnitType.kPercentage ? param.value / 100 : param.value;\n}\n/**\n * @see https://drafts.fxtf.org/filter-effects/#blurEquivalent\n */\nfunction createBlur(document, $filter, params) {\n    var $feGaussianBlur = createSVGElement('feGaussianBlur', document);\n    $feGaussianBlur.setAttribute('in', 'SourceGraphic');\n    $feGaussianBlur.setAttribute('stdDeviation', \"\".concat(params[0].value));\n    $filter.appendChild($feGaussianBlur);\n}\nfunction createFeComponentTransfer(document, $filter, _a) {\n    var type = _a.type, slope = _a.slope, intercept = _a.intercept, tableValues = _a.tableValues;\n    var $feComponentTransfer = createSVGElement('feComponentTransfer', document);\n    [\n        createSVGElement('feFuncR', document),\n        createSVGElement('feFuncG', document),\n        createSVGElement('feFuncB', document),\n    ].forEach(function ($feFunc) {\n        $feFunc.setAttribute('type', type);\n        if (type === 'table') {\n            $feFunc.setAttribute('tableValues', \"\".concat(tableValues));\n        }\n        else {\n            $feFunc.setAttribute('slope', \"\".concat(slope));\n            $feFunc.setAttribute('intercept', \"\".concat(intercept));\n        }\n        $feComponentTransfer.appendChild($feFunc);\n    });\n    $filter.appendChild($feComponentTransfer);\n}\nfunction createContrast(document, $filter, params) {\n    var slope = convertToAbsoluteValue(params[0]);\n    createFeComponentTransfer(document, $filter, {\n        type: 'linear',\n        slope: slope,\n        intercept: -(0.5 * slope) + 0.5,\n    });\n}\nfunction createInvert(document, $filter, params) {\n    var amount = convertToAbsoluteValue(params[0]);\n    createFeComponentTransfer(document, $filter, {\n        type: 'table',\n        tableValues: \"\".concat(amount, \" \").concat(1 - amount),\n    });\n}\nfunction createBrightness(document, $filter, params) {\n    var slope = convertToAbsoluteValue(params[0]);\n    createFeComponentTransfer(document, $filter, {\n        type: 'linear',\n        slope: slope,\n        intercept: 0,\n    });\n}\nfunction createSaturate(document, $filter, params) {\n    var amount = convertToAbsoluteValue(params[0]);\n    var $feColorMatrix = createSVGElement('feColorMatrix', document);\n    $feColorMatrix.setAttribute('type', 'saturate');\n    $feColorMatrix.setAttribute('values', \"\".concat(amount));\n    $filter.appendChild($feColorMatrix);\n}\nfunction createHueRotate(document, $filter, params) {\n    var $feColorMatrix = createSVGElement('feColorMatrix', document);\n    $feColorMatrix.setAttribute('type', 'hueRotate');\n    // $feColorMatrix.setAttribute('values', `${params[0].to(UnitType.kDegrees).value}`);\n    // FIXME: convert to degrees\n    $feColorMatrix.setAttribute('values', \"\".concat(params[0].value));\n    $filter.appendChild($feColorMatrix);\n}\nfunction createDropShadow(document, $filter, params) {\n    var shadowOffsetX = params[0].value;\n    var shadowOffsetY = params[1].value;\n    var shadowBlur = params[2].value;\n    // @ts-ignore\n    var shadowColor = params[3].formatted;\n    var $feGaussianBlur = createSVGElement('feGaussianBlur', document);\n    $feGaussianBlur.setAttribute('in', 'SourceAlpha');\n    $feGaussianBlur.setAttribute('stdDeviation', \"\".concat(shadowBlur));\n    $filter.appendChild($feGaussianBlur);\n    var $feOffset = createSVGElement('feOffset', document);\n    $feOffset.setAttribute('dx', \"\".concat(shadowOffsetX));\n    $feOffset.setAttribute('dy', \"\".concat(shadowOffsetY));\n    $feOffset.setAttribute('result', 'offsetblur');\n    $filter.appendChild($feOffset);\n    var $feFlood = createSVGElement('feFlood', document);\n    $feFlood.setAttribute('flood-color', shadowColor);\n    $filter.appendChild($feFlood);\n    var $feComposite = createSVGElement('feComposite', document);\n    $feComposite.setAttribute('in2', 'offsetblur');\n    $feComposite.setAttribute('operator', 'in');\n    $filter.appendChild($feComposite);\n    var $feMerge = createSVGElement('feMerge', document);\n    $filter.appendChild($feMerge);\n    var $feMergeNode1 = createSVGElement('feMergeNode', document);\n    var $feMergeNode2 = createSVGElement('feMergeNode', document);\n    $feMergeNode2.setAttribute('in', 'SourceGraphic');\n    $feMerge.appendChild($feMergeNode1);\n    $feMerge.appendChild($feMergeNode2);\n}\nfunction createFeColorMatrix(document, $filter, matrix) {\n    var $feColorMatrix = createSVGElement('feColorMatrix', document);\n    $feColorMatrix.setAttribute('type', 'matrix');\n    $feColorMatrix.setAttribute('values', matrix.join(' '));\n    $filter.appendChild($feColorMatrix);\n}\n/**\n * @see https://drafts.fxtf.org/filter-effects/#grayscaleEquivalent\n */\nfunction createGrayscale(document, $filter, params) {\n    var amount = convertToAbsoluteValue(params[0]);\n    createFeColorMatrix(document, $filter, [\n        0.2126 + 0.7874 * (1 - amount),\n        0.7152 - 0.7152 * (1 - amount),\n        0.0722 - 0.0722 * (1 - amount),\n        0,\n        0,\n        0.2126 - 0.2126 * (1 - amount),\n        0.7152 + 0.2848 * (1 - amount),\n        0.0722 - 0.0722 * (1 - amount),\n        0,\n        0,\n        0.2126 - 0.2126 * (1 - amount),\n        0.7152 - 0.7152 * (1 - amount),\n        0.0722 + 0.9278 * (1 - amount),\n        0,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n    ]);\n}\n/**\n * @see https://drafts.fxtf.org/filter-effects/#sepiaEquivalent\n */\nfunction createSepia(document, $filter, params) {\n    var amount = convertToAbsoluteValue(params[0]);\n    createFeColorMatrix(document, $filter, [\n        0.393 + 0.607 * (1 - amount),\n        0.769 - 0.769 * (1 - amount),\n        0.189 - 0.189 * (1 - amount),\n        0,\n        0,\n        0.349 - 0.349 * (1 - amount),\n        0.686 + 0.314 * (1 - amount),\n        0.168 - 0.168 * (1 - amount),\n        0,\n        0,\n        0.272 - 0.272 * (1 - amount),\n        0.534 - 0.534 * (1 - amount),\n        0.131 + 0.869 * (1 - amount),\n        0,\n        0,\n        0,\n        0,\n        0,\n        1,\n        0,\n    ]);\n}\n\nvar PATTERN_PREFIX = 'g-pattern-';\nvar cacheKey2IDMap = {};\nvar counter = 0;\nfunction resetPatternCounter() {\n    counter = 0;\n    cacheKey2IDMap = {};\n}\nfunction createOrUpdateGradientAndPattern(document, $def, object, $el, parsedColor, name, createImage, plugin) {\n    // eg. clipPath don't have fill/stroke\n    if (!parsedColor) {\n        return '';\n    }\n    if (isCSSRGB(parsedColor)) {\n        // keep using currentColor @see https://github.com/d3/d3-axis/issues/49\n        if (object.style[name] === 'currentColor') {\n            $el === null || $el === void 0 ? void 0 : $el.setAttribute(name, 'currentColor');\n        }\n        else {\n            // constant value, eg. '#fff'\n            $el === null || $el === void 0 ? void 0 : $el.setAttribute(name, parsedColor.isNone ? 'none' : parsedColor.toString());\n        }\n    }\n    else if (isPattern(parsedColor)) {\n        var patternId = createOrUpdatePattern(document, $def, object, parsedColor, createImage, plugin);\n        // use style instead of attribute when applying <pattern>\n        // @see https://stackoverflow.com/a/7723115\n        $el.style[name] = \"url(#\".concat(patternId, \")\");\n        return patternId;\n    }\n    else {\n        if (parsedColor.length === 1) {\n            var gradientId = createOrUpdateGradient(document, object, $def, $el, parsedColor[0]);\n            $el === null || $el === void 0 ? void 0 : $el.setAttribute(name, \"url(#\".concat(gradientId, \")\"));\n            return gradientId;\n        }\n        else {\n            // @see https://stackoverflow.com/questions/20671502/can-i-blend-gradients-in-svg\n            var filterId = createOrUpdateMultiGradient(document, object, $def, $el, parsedColor);\n            $el === null || $el === void 0 ? void 0 : $el.setAttribute('filter', \"url(#\".concat(filterId, \")\"));\n            $el === null || $el === void 0 ? void 0 : $el.setAttribute('fill', 'black');\n            return filterId;\n        }\n    }\n    return '';\n}\nfunction generateCacheKey(src, options) {\n    if (options === void 0) { options = {}; }\n    var cacheKey = '';\n    if (isCSSGradientValue(src)) {\n        var type = src.type, value = src.value;\n        if (type === GradientType.LinearGradient ||\n            type === GradientType.RadialGradient) {\n            // @ts-ignore\n            var _a = __assign(__assign({}, value), options), type_1 = _a.type, width = _a.width, height = _a.height, steps = _a.steps, angle = _a.angle, cx = _a.cx, cy = _a.cy, size = _a.size;\n            cacheKey = \"gradient-\".concat(type_1, \"-\").concat((angle === null || angle === void 0 ? void 0 : angle.toString()) || 0, \"-\").concat((cx === null || cx === void 0 ? void 0 : cx.toString()) || 0, \"-\").concat((cy === null || cy === void 0 ? void 0 : cy.toString()) || 0, \"-\").concat((size === null || size === void 0 ? void 0 : size.toString()) || 0, \"-\").concat(width, \"-\").concat(height, \"-\").concat(steps\n                .map(function (_a) {\n                var offset = _a.offset, color = _a.color;\n                return \"\".concat(offset).concat(color);\n            })\n                .join('-'));\n        }\n    }\n    else if (isPattern(src)) {\n        if (isString(src.image)) {\n            cacheKey = \"pattern-\".concat(src.image, \"-\").concat(src.repetition);\n        }\n        else if (src.image.nodeName === 'rect') {\n            // use rect's entity as key\n            cacheKey = \"pattern-rect-\".concat(src.image.entity);\n        }\n        else {\n            cacheKey = \"pattern-\".concat(counter);\n        }\n    }\n    if (cacheKey) {\n        if (!cacheKey2IDMap[cacheKey]) {\n            cacheKey2IDMap[cacheKey] = PATTERN_PREFIX + \"\".concat(counter++);\n        }\n    }\n    return cacheKey2IDMap[cacheKey];\n}\nfunction formatTransform(transform) {\n    // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/patternTransform\n    // should remove unit: rotate(20deg) -> rotate(20)\n    return parseTransform(transform)\n        .map(function (parsed) {\n        var t = parsed.t, d = parsed.d;\n        if (t === 'translate') {\n            return \"translate(\".concat(d[0].value, \" \").concat(d[1].value, \")\");\n        }\n        else if (t === 'translatex') {\n            return \"translate(\".concat(d[0].value, \" 0)\");\n        }\n        else if (t === 'translatey') {\n            return \"translate(0 \".concat(d[0].value, \")\");\n        }\n        else if (t === 'rotate') {\n            return \"rotate(\".concat(d[0].value, \")\");\n        }\n        else if (t === 'scale') {\n            // scale(1) scale(1, 1)\n            var newScale = (d === null || d === void 0 ? void 0 : d.map(function (s) { return s.value; })) || [1, 1];\n            return \"scale(\".concat(newScale[0], \", \").concat(newScale[1], \")\");\n        }\n        else if (t === 'scalex') {\n            var newScale = (d === null || d === void 0 ? void 0 : d.map(function (s) { return s.value; })) || [1];\n            return \"scale(\".concat(newScale[0], \", 1)\");\n        }\n        else if (t === 'scaley') {\n            var newScale = (d === null || d === void 0 ? void 0 : d.map(function (s) { return s.value; })) || [1];\n            return \"scale(1, \".concat(newScale[0], \")\");\n        }\n        else if (t === 'skew') {\n            var newSkew = (d === null || d === void 0 ? void 0 : d.map(function (s) { return s.value; })) || [0, 0];\n            return \"skewX(\".concat(newSkew[0], \") skewY(\").concat(newSkew[1], \")\");\n        }\n        else if (t === 'skewx') {\n            var newSkew = (d === null || d === void 0 ? void 0 : d.map(function (s) { return s.value; })) || [0];\n            return \"skewX(\".concat(newSkew[0], \")\");\n        }\n        else if (t === 'skewy') {\n            var newSkew = (d === null || d === void 0 ? void 0 : d.map(function (s) { return s.value; })) || [0];\n            return \"skewY(\".concat(newSkew[0], \")\");\n        }\n        else if (t === 'matrix') {\n            var _a = __read(d.map(function (s) { return s.value; }), 6), a = _a[0], b = _a[1], c = _a[2], dd = _a[3], tx = _a[4], ty = _a[5];\n            return \"matrix(\".concat(a, \" \").concat(b, \" \").concat(c, \" \").concat(dd, \" \").concat(tx, \" \").concat(ty, \")\");\n        }\n    })\n        .join(' ');\n}\nfunction create$Pattern(document, $def, object, pattern, patternId, width, height) {\n    var repetition = pattern.repetition, transform = pattern.transform;\n    // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/pattern\n    var $pattern = createSVGElement('pattern', document);\n    if (transform) {\n        $pattern.setAttribute('patternTransform', formatTransform(transform));\n    }\n    $pattern.setAttribute('patternUnits', 'userSpaceOnUse');\n    $pattern.id = patternId;\n    $def.appendChild($pattern);\n    $pattern.setAttribute('x', '0');\n    $pattern.setAttribute('y', '0');\n    var halfExtents = object.getGeometryBounds().halfExtents;\n    // There is no equivalent to CSS no-repeat for SVG patterns\n    // @see https://stackoverflow.com/a/33481956\n    var patternWidth = width;\n    var patternHeight = height;\n    if (repetition === 'repeat-x') {\n        patternHeight = halfExtents[1] * 2;\n    }\n    else if (repetition === 'repeat-y') {\n        patternWidth = halfExtents[0] * 2;\n    }\n    else if (repetition === 'no-repeat') {\n        patternWidth = halfExtents[0] * 2;\n        patternHeight = halfExtents[1] * 2;\n    }\n    $pattern.setAttribute('width', \"\".concat(patternWidth));\n    $pattern.setAttribute('height', \"\".concat(patternHeight));\n    return $pattern;\n}\nfunction createOrUpdatePattern(document, $def, object, pattern, createImage, plugin) {\n    var patternId = generateCacheKey(pattern);\n    var $existed = $def.querySelector(\"#\".concat(patternId));\n    if (!$existed) {\n        var image = pattern.image;\n        var imageURL = '';\n        if (isString(image)) {\n            imageURL = image;\n        }\n        else {\n            if (isBrowser) {\n                if (image instanceof HTMLImageElement) {\n                    imageURL = image.src;\n                }\n                else if (image instanceof HTMLCanvasElement) {\n                    imageURL = image.toDataURL();\n                }\n                else ;\n            }\n        }\n        if (imageURL) {\n            var $image_1 = createSVGElement('image', document);\n            // use href instead of xlink:href\n            // @see https://stackoverflow.com/a/13379007\n            $image_1.setAttribute('href', imageURL);\n            var img_1;\n            if (createImage) {\n                img_1 = createImage(imageURL);\n            }\n            else if (isBrowser) {\n                img_1 = new window.Image();\n            }\n            if (!imageURL.match(/^data:/i)) {\n                img_1.crossOrigin = 'Anonymous';\n                $image_1.setAttribute('crossorigin', 'anonymous');\n            }\n            img_1.src = imageURL;\n            var onload_1 = function () {\n                var $pattern = create$Pattern(document, $def, object, pattern, patternId, img_1.width, img_1.height);\n                $def.appendChild($pattern);\n                $pattern.appendChild($image_1);\n                $image_1.setAttribute('x', '0');\n                $image_1.setAttribute('y', '0');\n                $image_1.setAttribute('width', \"\".concat(img_1.width));\n                $image_1.setAttribute('height', \"\".concat(img_1.height));\n            };\n            if (img_1.complete) {\n                onload_1();\n            }\n            else {\n                img_1.onload = onload_1;\n                // Fix onload() bug in IE9\n                // img.src = img.src;\n            }\n        }\n        if (image.nodeName === 'rect') {\n            var _a = image.parsedStyle, width = _a.width, height = _a.height;\n            var $pattern = create$Pattern(document, $def, image, pattern, patternId, width, height);\n            // traverse subtree of pattern\n            image.forEach(function (object) {\n                plugin.createSVGDom(document, object, null);\n                // @ts-ignore\n                var svgElement = object.elementSVG;\n                // apply local RTS transformation to <group> wrapper\n                // account for anchor\n                var localTransform = object.getLocalTransform();\n                plugin.applyTransform(svgElement.$groupEl, localTransform);\n            });\n            // @ts-ignore\n            var svgElement = image.elementSVG;\n            $pattern.appendChild(svgElement.$groupEl);\n        }\n    }\n    return patternId;\n}\nfunction createOrUpdateGradient(document, object, $def, $el, parsedColor) {\n    var bounds = object.getGeometryBounds();\n    var width = (bounds && bounds.halfExtents[0] * 2) || 0;\n    var height = (bounds && bounds.halfExtents[1] * 2) || 0;\n    var gradientId = generateCacheKey(parsedColor, { width: width, height: height });\n    var $existed = $def.querySelector(\"#\".concat(gradientId));\n    if (!$existed) {\n        // <linearGradient> <radialGradient>\n        // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/linearGradient\n        // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/radialGradient\n        $existed = createSVGElement(parsedColor.type === GradientType.LinearGradient\n            ? 'linearGradient'\n            : 'radialGradient', document);\n        // @see https://github.com/antvis/g/issues/1025\n        $existed.setAttribute('gradientUnits', 'userSpaceOnUse');\n        // add stops\n        var innerHTML_1 = '';\n        parsedColor.value.steps\n            // sort by offset @see https://github.com/antvis/G/issues/1171\n            .sort(function (a, b) { return a.offset.value - b.offset.value; })\n            .forEach(function (_a) {\n            var offset = _a.offset, color = _a.color;\n            // TODO: support absolute unit like `px`\n            innerHTML_1 += \"<stop offset=\\\"\".concat(offset.value / 100, \"\\\" stop-color=\\\"\").concat(color, \"\\\"></stop>\");\n        });\n        $existed.innerHTML = innerHTML_1;\n        $existed.id = gradientId;\n        $def.appendChild($existed);\n    }\n    if (parsedColor.type === GradientType.LinearGradient) {\n        var angle = parsedColor.value.angle;\n        var _a = computeLinearGradient(width, height, angle), x1 = _a.x1, y1 = _a.y1, x2 = _a.x2, y2 = _a.y2;\n        $existed.setAttribute('x1', \"\".concat(x1));\n        $existed.setAttribute('y1', \"\".concat(y1));\n        $existed.setAttribute('x2', \"\".concat(x2));\n        $existed.setAttribute('y2', \"\".concat(y2));\n        // $existed.setAttribute('gradientTransform', `rotate(${angle})`);\n    }\n    else {\n        var _b = parsedColor.value, cx = _b.cx, cy = _b.cy, size = _b.size;\n        var _c = computeRadialGradient(width, height, cx, cy, size), x = _c.x, y = _c.y, r = _c.r;\n        $existed.setAttribute('cx', \"\".concat(x));\n        $existed.setAttribute('cy', \"\".concat(y));\n        $existed.setAttribute('r', \"\".concat(r));\n    }\n    return gradientId;\n}\nfunction createOrUpdateMultiGradient(document, object, $def, $el, gradients) {\n    var filterId = FILTER_PREFIX + object.entity + '-gradient';\n    var $existed = $def.querySelector(\"#\".concat(filterId));\n    if (!$existed) {\n        $existed = createSVGElement('filter', document);\n        $existed.setAttribute('filterUnits', 'userSpaceOnUse');\n        // @see https://github.com/antvis/g/issues/1025\n        $existed.setAttribute('x', '0%');\n        $existed.setAttribute('y', '0%');\n        $existed.setAttribute('width', '100%');\n        $existed.setAttribute('height', '100%');\n        $existed.id = filterId;\n        $def.appendChild($existed);\n    }\n    /**\n     * <rect id=\"wave-rect\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" fill=\"url(#wave)\"></rect>\n     * <filter id=\"blend-it\" x=\"0%\" y=\"0%\" width=\"100%\" height=\"100%\">\n          <feImage xlink:href=\"#wave-rect\" result=\"myWave\" x=\"100\" y=\"100\"/>\n          <feImage xlink:href=\"#ry-rect\" result=\"myRY\"  x=\"100\" y=\"100\"/>\n          <feBlend in=\"myWave\" in2=\"myRY\" mode=\"multiply\" result=\"blendedGrad\"/>\n          <feComposite in=\"blendedGrad\" in2=\"SourceGraphic\" operator=\"in\"/>\n      </filter>\n     */\n    var blended = 0;\n    gradients.forEach(function (gradient, i) {\n        var gradientId = createOrUpdateGradient(document, object, $def, $el, gradient);\n        var rectId = gradientId + '_rect';\n        var $rect = createSVGElement('rect', document);\n        $rect.setAttribute('x', '0');\n        $rect.setAttribute('y', '0');\n        $rect.setAttribute('width', '100%');\n        $rect.setAttribute('height', '100%');\n        $rect.setAttribute('fill', \"url(#\".concat(gradientId, \")\"));\n        $rect.id = rectId;\n        $def.appendChild($rect);\n        var $feImage = createSVGElement('feImage', document);\n        $feImage.setAttribute('href', \"#\".concat(rectId));\n        $feImage.setAttribute('result', \"\".concat(filterId, \"-\").concat(i));\n        $existed.appendChild($feImage);\n        if (i > 0) {\n            var $feBlend = createSVGElement('feBlend', document);\n            $feBlend.setAttribute('in', i === 1 ? \"\".concat(filterId, \"-\").concat(i - 1) : \"\".concat(filterId, \"-blended-\").concat(blended - 1));\n            $feBlend.setAttribute('in2', \"\".concat(filterId, \"-\").concat(i));\n            $feBlend.setAttribute('result', \"\".concat(filterId, \"-blended-\").concat(blended++));\n            // @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/blend-mode\n            $feBlend.setAttribute('mode', 'multiply');\n            $existed.appendChild($feBlend);\n        }\n    });\n    var $feComposite = createSVGElement('feComposite', document);\n    $feComposite.setAttribute('in', \"\".concat(filterId, \"-blended-\").concat(blended));\n    $feComposite.setAttribute('in2', 'SourceGraphic');\n    $feComposite.setAttribute('operator', 'in');\n    $existed.appendChild($feComposite);\n    return filterId;\n}\n\nvar FILTER_DROPSHADOW_PREFIX = 'g-filter-dropshadow-';\n/**\n * use SVG filters\n * @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/filter\n */\nfunction createOrUpdateShadow(document, $def, object, $el, name) {\n    var _a = object.parsedStyle, shadowType = _a.shadowType, shadowBlur = _a.shadowBlur, shadowColor = _a.shadowColor, shadowOffsetX = _a.shadowOffsetX, shadowOffsetY = _a.shadowOffsetY;\n    var hasShadow = !isNil(shadowColor) && shadowBlur > 0;\n    var shadowId = FILTER_DROPSHADOW_PREFIX + object.entity;\n    var $existedFilter = $def.querySelector(\"#\".concat(shadowId));\n    if ($existedFilter) {\n        var existedShadowType = $existedFilter.getAttribute('data-type');\n        if (existedShadowType !== shadowType || !hasShadow) {\n            // remove existed shadow\n            $existedFilter.remove();\n            $existedFilter = null;\n        }\n    }\n    // <Group> also has shadowType as its default value\n    // only apply shadow when blur > 0\n    if (hasShadow) {\n        // use filter <feDropShadow>\n        // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Element/feDropShadow\n        $el === null || $el === void 0 ? void 0 : $el.setAttribute('filter', \"url(#\".concat(shadowId, \")\"));\n    }\n    else {\n        $el === null || $el === void 0 ? void 0 : $el.removeAttribute('filter');\n        return;\n    }\n    if (!$existedFilter) {\n        $existedFilter = createSVGElement('filter', document);\n        $existedFilter.setAttribute('data-type', shadowType);\n        if (shadowType === 'outer') {\n            var $feDropShadow = createSVGElement('feDropShadow', document);\n            $feDropShadow.setAttribute('dx', \"\".concat((shadowOffsetX || 0) / 2));\n            $feDropShadow.setAttribute('dy', \"\".concat((shadowOffsetY || 0) / 2));\n            $feDropShadow.setAttribute('stdDeviation', \"\".concat((shadowBlur || 0) / 4));\n            $feDropShadow.setAttribute('flood-color', shadowColor.toString());\n            $existedFilter.appendChild($feDropShadow);\n        }\n        else if (shadowType === 'inner') {\n            var $feComponentTransfer = createSVGElement('feComponentTransfer', document);\n            $feComponentTransfer.setAttribute('in', 'SourceAlpha');\n            var $feFuncA = createSVGElement('feFuncA', document);\n            $feFuncA.setAttribute('type', 'table');\n            $feFuncA.setAttribute('tableValues', '1 0');\n            $feComponentTransfer.appendChild($feFuncA);\n            $existedFilter.appendChild($feComponentTransfer);\n            var $feGaussianBlur = createSVGElement('feGaussianBlur', document);\n            $feGaussianBlur.setAttribute('stdDeviation', \"\".concat((shadowBlur || 0) / 4));\n            $existedFilter.appendChild($feGaussianBlur);\n            var $feOffset = createSVGElement('feOffset', document);\n            $feOffset.setAttribute('dx', \"\".concat((shadowOffsetX || 0) / 2));\n            $feOffset.setAttribute('dy', \"\".concat((shadowOffsetY || 0) / 2));\n            $feOffset.setAttribute('result', 'offsetblur');\n            $existedFilter.appendChild($feOffset);\n            var $feFlood = createSVGElement('feFlood', document);\n            $feFlood.setAttribute('flood-color', shadowColor.toString());\n            $feFlood.setAttribute('result', 'color');\n            $existedFilter.appendChild($feFlood);\n            var $feComposite = createSVGElement('feComposite', document);\n            $feComposite.setAttribute('in2', 'offsetblur');\n            $feComposite.setAttribute('operator', 'in');\n            $existedFilter.appendChild($feComposite);\n            var $feComposite2 = createSVGElement('feComposite', document);\n            $feComposite2.setAttribute('in2', 'SourceAlpha');\n            $feComposite2.setAttribute('operator', 'in');\n            $existedFilter.appendChild($feComposite2);\n            var $feMerge = createSVGElement('feMerge', document);\n            $existedFilter.appendChild($feMerge);\n            var $feMergeNode = createSVGElement('feMergeNode', document);\n            $feMergeNode.setAttribute('in', 'SourceGraphic');\n            var $feMergeNode2 = createSVGElement('feMergeNode', document);\n            $feMerge.appendChild($feMergeNode);\n            $feMerge.appendChild($feMergeNode2);\n        }\n        $existedFilter.id = shadowId;\n        // @see https://github.com/antvis/g/issues/1025\n        $existedFilter.setAttribute('filterUnits', 'userSpaceOnUse');\n        $def.appendChild($existedFilter);\n        return;\n    }\n    if (shadowType === 'inner') {\n        var $feGaussianBlur = $existedFilter.children[1];\n        var $feOffset = $existedFilter.children[2];\n        var $feFlood = $existedFilter.children[3];\n        if (name === 'shadowColor') {\n            $feFlood.setAttribute('flood-color', shadowColor.toString());\n        }\n        else if (name === 'shadowBlur') {\n            // half the blur radius\n            // @see https://drafts.csswg.org/css-backgrounds/#shadow-blur\n            // @see https://css-tricks.com/breaking-css-box-shadow-vs-drop-shadow/\n            $feGaussianBlur.setAttribute('stdDeviation', \"\".concat((shadowBlur || 0) / 4));\n        }\n        else if (name === 'shadowOffsetX') {\n            $feOffset.setAttribute('dx', \"\".concat((shadowOffsetX || 0) / 2));\n        }\n        else if (name === 'shadowOffsetY') {\n            $feOffset.setAttribute('dy', \"\".concat((shadowOffsetY || 0) / 2));\n        }\n    }\n    else if (shadowType === 'outer') {\n        var $feDropShadow = $existedFilter.children[0];\n        if (name === 'shadowColor') {\n            $feDropShadow.setAttribute('flood-color', shadowColor.toString());\n        }\n        else if (name === 'shadowBlur') {\n            // half the blur radius\n            // @see https://drafts.csswg.org/css-backgrounds/#shadow-blur\n            // @see https://css-tricks.com/breaking-css-box-shadow-vs-drop-shadow/\n            $feDropShadow.setAttribute('stdDeviation', \"\".concat((shadowBlur || 0) / 4));\n        }\n        else if (name === 'shadowOffsetX') {\n            $feDropShadow.setAttribute('dx', \"\".concat((shadowOffsetX || 0) / 2));\n        }\n        else if (name === 'shadowOffsetY') {\n            $feDropShadow.setAttribute('dy', \"\".concat((shadowOffsetY || 0) / 2));\n        }\n    }\n}\n\nvar urlRegexp = /url\\(\"?#(.*)\\)/;\nvar DefElementManager = /** @class */ (function () {\n    function DefElementManager(context) {\n        this.context = context;\n        this.gradientCache = {};\n    }\n    DefElementManager.prototype.getDefElement = function () {\n        return this.$def;\n    };\n    DefElementManager.prototype.init = function () {\n        var document = this.context.config.document;\n        var $svg = this.context.contextService.getContext();\n        this.$def = createSVGElement('defs', document);\n        $svg.appendChild(this.$def);\n    };\n    DefElementManager.prototype.clear = function (entity) {\n        var _this = this;\n        Object.keys(this.gradientCache).forEach(function (id) {\n            _this.clearUnusedDefElement(_this.gradientCache, id, entity);\n        });\n    };\n    DefElementManager.prototype.clearUnusedDefElement = function (cache, id, entity) {\n        if (cache[id] && cache[id].size === 1 && cache[id].has(entity)) {\n            var targetElement = this.$def.querySelector(\"#\".concat(id));\n            if (targetElement) {\n                this.$def.removeChild(targetElement);\n            }\n        }\n    };\n    DefElementManager.prototype.createOrUpdateGradientAndPattern = function (object, $el, parsedColor, name, plugin) {\n        var _a = this.context.config, doc = _a.document, createImage = _a.createImage;\n        if ($el) {\n            var attributeValue = '';\n            if (isPattern(parsedColor)) {\n                // `fill: url(#${patternId})`\n                attributeValue = $el.style[name];\n            }\n            else {\n                // `url(#${gradientId})`\n                attributeValue = $el.getAttribute(name) || '';\n            }\n            var matches = attributeValue.match(urlRegexp);\n            if (matches && matches.length > 1) {\n                this.clearUnusedDefElement(this.gradientCache, matches[1].replace('\"', ''), object.entity);\n            }\n            var newDefElementId = createOrUpdateGradientAndPattern(doc || document, this.$def, object, $el, parsedColor, name, createImage, plugin);\n            if (newDefElementId) {\n                if (!this.gradientCache[newDefElementId]) {\n                    this.gradientCache[newDefElementId] = new Set();\n                }\n                this.gradientCache[newDefElementId].add(object.entity);\n            }\n        }\n    };\n    DefElementManager.prototype.createOrUpdateShadow = function (object, $el, name) {\n        var doc = this.context.config.document;\n        createOrUpdateShadow(doc || document, this.$def, object, $el, name);\n    };\n    DefElementManager.prototype.createOrUpdateFilter = function (object, $el, filters) {\n        var doc = this.context.config.document;\n        createOrUpdateFilter(doc || document, this.$def, object, $el, filters);\n    };\n    return DefElementManager;\n}());\n\nfunction numberToLongString(x) {\n    return x.toFixed(6).replace('.000000', '');\n}\nfunction convertHTML(str) {\n    var regex = /[&|<|>|\"|']/g;\n    return str.replace(regex, function (match) {\n        if (match === '&') {\n            return '&amp;';\n        }\n        else if (match === '<') {\n            return '&lt;';\n        }\n        else if (match === '>') {\n            return '&gt;';\n        }\n        else if (match === '\"') {\n            return '&quot;';\n        }\n        else {\n            return '&apos;';\n        }\n    });\n}\n\nvar SVG_ATTR_MAP = {\n    opacity: 'opacity',\n    fillStyle: 'fill',\n    fill: 'fill',\n    fillRule: 'fill-rule',\n    fillOpacity: 'fill-opacity',\n    strokeStyle: 'stroke',\n    strokeOpacity: 'stroke-opacity',\n    stroke: 'stroke',\n    clipPath: 'clip-path',\n    textPath: 'text-path',\n    r: 'r',\n    rx: 'rx',\n    ry: 'ry',\n    width: 'width',\n    height: 'height',\n    lineCap: 'stroke-linecap',\n    lineJoin: 'stroke-linejoin',\n    lineWidth: 'stroke-width',\n    lineDash: 'stroke-dasharray',\n    lineDashOffset: 'stroke-dashoffset',\n    miterLimit: 'stroke-miterlimit',\n    font: 'font',\n    fontSize: 'font-size',\n    fontStyle: 'font-style',\n    fontVariant: 'font-variant',\n    fontWeight: 'font-weight',\n    fontFamily: 'font-family',\n    letterSpacing: 'letter-spacing',\n    startArrow: 'marker-start',\n    endArrow: 'marker-end',\n    class: 'class',\n    id: 'id',\n    // style: 'style',\n    preserveAspectRatio: 'preserveAspectRatio',\n    visibility: 'visibility',\n    anchor: 'anchor',\n    shadowColor: 'flood-color',\n    shadowBlur: 'stdDeviation',\n    shadowOffsetX: 'dx',\n    shadowOffsetY: 'dy',\n    filter: 'filter',\n    innerHTML: 'innerHTML',\n    textAlign: 'text-anchor',\n    pointerEvents: 'pointer-events',\n};\nvar FORMAT_VALUE_MAP = {\n    textAlign: {\n        inherit: 'inherit',\n        left: 'left',\n        start: 'left',\n        center: 'middle',\n        right: 'end',\n        end: 'end',\n    },\n};\nvar DEFAULT_VALUE_MAP = {\n    textAlign: 'inherit',\n    // textBaseline: 'alphabetic',\n    // @see https://www.w3.org/TR/SVG/painting.html#LineCaps\n    lineCap: 'butt',\n    // @see https://www.w3.org/TR/SVG/painting.html#LineJoin\n    lineJoin: 'miter',\n    // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Attribute/stroke-width\n    lineWidth: '1px',\n    opacity: '1',\n    fillOpacity: '1',\n    fillRule: 'nonzero',\n    strokeOpacity: '1',\n    strokeWidth: '0',\n    strokeMiterLimit: '4',\n    letterSpacing: '0',\n    fontSize: 'inherit',\n    fontFamily: 'inherit',\n    pointerEvents: 'auto',\n};\n/**\n * G_SVG_PREFIX + nodeName + entity\n *\n * eg. g_svg_circle_345\n */\nvar G_SVG_PREFIX = 'g-svg';\nvar CLIP_PATH_PREFIX = 'clip-path-';\nvar TEXT_PATH_PREFIX = 'text-path-';\nvar SVGRendererPlugin = /** @class */ (function () {\n    function SVGRendererPlugin(pluginOptions, defElementManager, context) {\n        this.pluginOptions = pluginOptions;\n        this.defElementManager = defElementManager;\n        this.context = context;\n        /**\n         * Will be used in g-plugin-svg-picker for finding relative SVG element of current DisplayObject.\n         */\n        this.svgElementMap = new WeakMap();\n        /**\n         * render at the end of frame\n         */\n        this.renderQueue = [];\n        /**\n         * dirty attributes at the end of frame\n         */\n        this.dirtyAttributes = new WeakMap();\n        /**\n         * reorder after mounted\n         */\n        this.pendingReorderQueue = new Set();\n        /**\n         * <use> elements in <clipPath>, which should be sync with clipPath\n         *\n         * @example\n         * <clipPath transform=\"matrix(1,0,0,1,-100,-155)\" id=\"clip-path-0-2\">\n         *  <use href=\"#g_svg_circle_0\" transform=\"matrix(1.477115,0,0,1.477115,150,150)\">\n         *  </use>\n         * </clipPath>\n         */\n        this.clipPathUseMap = new WeakMap();\n    }\n    SVGRendererPlugin.prototype.apply = function (context) {\n        var _this = this;\n        var renderingService = context.renderingService, renderingContext = context.renderingContext;\n        this.context = context;\n        // @ts-ignore\n        this.context.svgElementMap = this.svgElementMap;\n        var canvas = renderingContext.root.ownerDocument.defaultView;\n        var document = this.context.config.document;\n        var handleMounted = function (e) {\n            var object = e.target;\n            // should remove clipPath already existed in <defs>\n            var $useRefs = _this.clipPathUseMap.get(object);\n            if ($useRefs) {\n                var $def = _this.defElementManager.getDefElement();\n                var existed = $def.querySelector(\"#\".concat(_this.getId(object)));\n                if (existed) {\n                    existed.remove();\n                }\n            }\n            // create SVG DOM Node\n            _this.createSVGDom(document, object, _this.$camera);\n        };\n        var handleUnmounted = function (e) {\n            var object = e.target;\n            _this.defElementManager.clear(object.entity);\n            _this.clipPathUseMap.delete(object);\n            _this.removeSVGDom(object);\n        };\n        var reorderChildren = function (object) {\n            var _a, _b;\n            var parent = object.parentNode;\n            // @ts-ignore\n            var $groupEl = (_b = (_a = object.parentNode) === null || _a === void 0 ? void 0 : _a.elementSVG) === null || _b === void 0 ? void 0 : _b.$groupEl;\n            var children = ((parent === null || parent === void 0 ? void 0 : parent.children) || []).slice();\n            if ($groupEl) {\n                _this.reorderChildren(document, $groupEl, children);\n            }\n        };\n        var handleReparent = function (e) {\n            var object = e.target;\n            reorderChildren(object);\n        };\n        var handleAttributeChanged = function (e) {\n            var object = e.target;\n            // @see https://github.com/antvis/g/issues/994\n            // @ts-ignore\n            if (!object.elementSVG) {\n                return;\n            }\n            var attrName = e.attrName;\n            var attribtues = _this.dirtyAttributes.get(object);\n            if (!attribtues) {\n                _this.dirtyAttributes.set(object, []);\n                attribtues = _this.dirtyAttributes.get(object);\n            }\n            attribtues.push(attrName);\n        };\n        var handleGeometryBoundsChanged = function (e) {\n            var _a;\n            var object = e.target;\n            // @ts-ignore\n            var $el = (_a = object.elementSVG) === null || _a === void 0 ? void 0 : _a.$el;\n            var _b = object.parsedStyle, fill = _b.fill, stroke = _b.stroke, clipPath = _b.clipPath;\n            if (fill && !isCSSRGB(fill)) {\n                _this.defElementManager.createOrUpdateGradientAndPattern(object, $el, fill, 'fill', _this);\n            }\n            if (stroke && !isCSSRGB(stroke)) {\n                _this.defElementManager.createOrUpdateGradientAndPattern(object, $el, stroke, 'stroke', _this);\n            }\n            if (clipPath) {\n                var parentInvert = mat4.invert(mat4.create(), object.getWorldTransform());\n                var clipPathId = CLIP_PATH_PREFIX + clipPath.entity + '-' + object.entity;\n                var $def = _this.defElementManager.getDefElement();\n                var $existed = $def.querySelector(\"#\".concat(clipPathId));\n                if ($existed) {\n                    _this.applyTransform($existed, parentInvert);\n                }\n            }\n        };\n        renderingService.hooks.init.tap(SVGRendererPlugin.tag, function () {\n            var _a = _this.context.config, background = _a.background, document = _a.document;\n            // <defs>\n            _this.defElementManager.init();\n            var $svg = _this.context.contextService.getContext();\n            if (background) {\n                $svg.style.background = background;\n            }\n            // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/color-interpolation-filters\n            $svg.setAttribute('color-interpolation-filters', 'sRGB');\n            _this.$camera = createSVGElement('g', document);\n            _this.$camera.id = \"\".concat(G_SVG_PREFIX, \"-camera\");\n            _this.applyTransform(_this.$camera, _this.context.camera.getOrthoMatrix());\n            $svg.appendChild(_this.$camera);\n            canvas.addEventListener(ElementEvent.MOUNTED, handleMounted);\n            canvas.addEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n            canvas.addEventListener(ElementEvent.REPARENT, handleReparent);\n            canvas.addEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n            canvas.addEventListener(ElementEvent.BOUNDS_CHANGED, handleGeometryBoundsChanged);\n        });\n        renderingService.hooks.destroy.tap(SVGRendererPlugin.tag, function () {\n            canvas.removeEventListener(ElementEvent.MOUNTED, handleMounted);\n            canvas.removeEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n            canvas.removeEventListener(ElementEvent.REPARENT, handleReparent);\n            canvas.removeEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n            canvas.removeEventListener(ElementEvent.BOUNDS_CHANGED, handleGeometryBoundsChanged);\n            resetPatternCounter();\n        });\n        renderingService.hooks.render.tap(SVGRendererPlugin.tag, function (object) {\n            _this.renderQueue.push(object);\n        });\n        renderingService.hooks.beginFrame.tap(SVGRendererPlugin.tag, function () {\n            var doc = _this.context.config.document;\n            if (_this.pendingReorderQueue.size) {\n                _this.pendingReorderQueue.forEach(function (object) {\n                    var _a;\n                    var children = ((object === null || object === void 0 ? void 0 : object.children) || []).slice();\n                    var $parentGroupEl = \n                    // @ts-ignore\n                    (_a = object === null || object === void 0 ? void 0 : object.elementSVG) === null || _a === void 0 ? void 0 : _a.$groupEl;\n                    if ($parentGroupEl) {\n                        _this.reorderChildren(doc || document, $parentGroupEl, children || []);\n                    }\n                });\n                _this.pendingReorderQueue.clear();\n            }\n        });\n        renderingService.hooks.endFrame.tap(SVGRendererPlugin.tag, function () {\n            if (renderingContext.renderReasons.has(RenderReason.CAMERA_CHANGED)) {\n                _this.applyTransform(_this.$camera, _this.context.camera.getOrthoMatrix());\n            }\n            _this.renderQueue.forEach(function (object) {\n                var _a, _b;\n                var $el = (_a = object.elementSVG) === null || _a === void 0 ? void 0 : _a.$el;\n                var $groupEl = (_b = object.elementSVG) === null || _b === void 0 ? void 0 : _b.$groupEl;\n                if ($el && $groupEl) {\n                    // apply local RTS transformation to <group> wrapper\n                    // account for anchor\n                    var localTransform = object.getLocalTransform();\n                    _this.applyTransform($groupEl, localTransform);\n                    // clipped shapes should also be informed\n                    var $useRefs = _this.clipPathUseMap.get(object);\n                    if ($useRefs && $useRefs.length) {\n                        $useRefs.forEach(function ($use) {\n                            // <clipPath transform=\"matrix()\"><circle /></clipPath>\n                            _this.applyTransform($use, object.getWorldTransform());\n                            // const parentInvert = mat4.invert(\n                            //   mat4.create(),\n                            //   (object as DisplayObject).getWorldTransform(),\n                            // );\n                            // this.applyTransform($clipPath, parentInvert);\n                        });\n                    }\n                    // finish rendering, clear dirty flag\n                    object.renderable.dirty = false;\n                }\n                // update dirty attributes\n                var attributes = _this.dirtyAttributes.get(object);\n                if (attributes) {\n                    attributes.forEach(function (attrName) {\n                        if (attrName === 'zIndex') {\n                            reorderChildren(object);\n                        }\n                        else if (attrName === 'increasedLineWidthForHitTesting') {\n                            _this.createOrUpdateHitArea(object, $el, $groupEl);\n                        }\n                        _this.updateAttribute(object, [attrName]);\n                    });\n                    _this.dirtyAttributes.delete(object);\n                }\n            });\n            _this.renderQueue = [];\n        });\n    };\n    SVGRendererPlugin.prototype.getId = function (object) {\n        return object.id || \"\".concat(G_SVG_PREFIX, \"-\").concat(object.entity);\n    };\n    SVGRendererPlugin.prototype.reorderChildren = function (doc, $groupEl, children) {\n        // need to reorder parent's children\n        children.sort(function (a, b) { return a.sortable.renderOrder - b.sortable.renderOrder; });\n        if (children.length) {\n            // create empty fragment\n            var fragment_1 = (doc || document).createDocumentFragment();\n            children.forEach(function (child) {\n                if (child.isConnected) {\n                    var $el = child.elementSVG.$groupEl;\n                    if ($el) {\n                        fragment_1.appendChild($el);\n                    }\n                }\n            });\n            $groupEl.appendChild(fragment_1);\n        }\n    };\n    SVGRendererPlugin.prototype.applyTransform = function ($el, rts) {\n        // use proper precision avoiding too long string in `transform`\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Transformations\n        $el.setAttribute('transform', \"matrix(\".concat(numberToLongString(rts[0]), \",\").concat(numberToLongString(rts[1]), \",\").concat(numberToLongString(rts[4]), \",\").concat(numberToLongString(rts[5]), \",\").concat(numberToLongString(rts[12]), \",\").concat(numberToLongString(rts[13]), \")\"));\n    };\n    SVGRendererPlugin.prototype.applyAttributes = function (object) {\n        var elementSVG = object.elementSVG;\n        var $el = elementSVG === null || elementSVG === void 0 ? void 0 : elementSVG.$el;\n        var $groupEl = elementSVG === null || elementSVG === void 0 ? void 0 : elementSVG.$groupEl;\n        if ($el && $groupEl) {\n            var nodeName = object.nodeName, attributes = object.attributes;\n            if (nodeName !== Shape.HTML) {\n                $el.setAttribute('fill', 'none');\n            }\n            if (nodeName === Shape.IMAGE) {\n                $el.setAttribute('preserveAspectRatio', 'none');\n            }\n            // apply attributes\n            this.updateAttribute(object, Object.keys(attributes));\n        }\n    };\n    SVGRendererPlugin.prototype.updateAttribute = function (object, attributes) {\n        var _this = this;\n        var enableCSSParsing = this.context.enableCSSParsing;\n        var document = this.context.config.document;\n        var _a = object\n            .elementSVG, $el = _a.$el, $groupEl = _a.$groupEl, $hitTestingEl = _a.$hitTestingEl;\n        var parsedStyle = object.parsedStyle, computedStyle = object.computedStyle, nodeName = object.nodeName;\n        var shouldUpdateElementAttribute = attributes.some(function (name) {\n            // @ts-ignore\n            return _this.context.SVGElementLifeCycleContribution.shouldUpdateElementAttribute(object, name);\n        });\n        // need re-generate path\n        if (shouldUpdateElementAttribute && $el) {\n            [$el, $hitTestingEl].forEach(function ($el) {\n                if ($el) {\n                    // @ts-ignore\n                    _this.context.SVGElementLifeCycleContribution.updateElementAttribute(object, $el, _this.svgElementMap);\n                    if (object.nodeName !== Shape.TEXT) {\n                        _this.updateAnchorWithTransform(object);\n                    }\n                }\n            });\n        }\n        // update common attributes\n        attributes.forEach(function (name) {\n            var _a, _b;\n            var usedName = SVG_ATTR_MAP[name];\n            var computedValue = enableCSSParsing\n                ? computedStyle[name]\n                : parsedStyle[name];\n            var computedValueStr = !isNil(computedValue) && computedValue.toString();\n            var formattedValueStr = ((_a = FORMAT_VALUE_MAP[name]) === null || _a === void 0 ? void 0 : _a[computedValueStr]) || computedValueStr;\n            var usedValue = parsedStyle[name];\n            var inherited = usedName && !!((_b = propertyMetadataCache[name]) === null || _b === void 0 ? void 0 : _b.inh);\n            // <foreignObject>\n            if (nodeName === Shape.HTML) {\n                if (name === 'fill') {\n                    $el.style.background = usedValue.toString();\n                }\n                else if (name === 'stroke') {\n                    $el.style['border-color'] = usedValue.toString();\n                    $el.style['border-style'] = 'solid';\n                }\n                else if (name === 'lineWidth') {\n                    $el.style['border-width'] = \"\".concat(usedValue || 0, \"px\");\n                }\n                else if (name === 'lineDash') {\n                    $el.style['border-style'] = 'dashed';\n                }\n                else if (name === 'innerHTML') {\n                    _this.createOrUpdateInnerHTML(document, $el, usedValue);\n                }\n                else if (name === 'width' || name === 'height' || name === 'class') {\n                    // width & height are both required for <foreignObject> and cannot be used as style.\n                    $el.setAttribute(name, usedValue.toString());\n                }\n                else if (name !== 'x' &&\n                    name !== 'y' &&\n                    !isNil(object.style[name]) &&\n                    object.style[name] !== '') {\n                    $el.style[name] = object.style[name];\n                }\n            }\n            else {\n                if (!usedName ||\n                    ((nodeName === Shape.GROUP || object.isCustomElement) &&\n                        !enableCSSParsing &&\n                        (inherited || usedName === 'fill' || usedName === 'stroke'))) {\n                    return;\n                }\n                if (name === 'fill') {\n                    _this.defElementManager.createOrUpdateGradientAndPattern(object, $el, usedValue, usedName, _this);\n                }\n                else if (name === 'stroke') {\n                    _this.defElementManager.createOrUpdateGradientAndPattern(object, $el, usedValue, usedName, _this);\n                }\n                else if (enableCSSParsing && inherited) {\n                    // use computed value\n                    // update `visibility` on <group>\n                    if (computedValueStr !== 'unset' &&\n                        computedValueStr !== DEFAULT_VALUE_MAP[name]) {\n                        $groupEl === null || $groupEl === void 0 ? void 0 : $groupEl.setAttribute(usedName, formattedValueStr);\n                    }\n                    else {\n                        $groupEl === null || $groupEl === void 0 ? void 0 : $groupEl.removeAttribute(usedName);\n                    }\n                }\n                else if (name === 'clipPath') {\n                    _this.createOrUpdateClipOrTextPath(document, usedValue, object);\n                }\n                else if (name === 'textPath') {\n                    _this.createOrUpdateClipOrTextPath(document, usedValue, object, true);\n                }\n                else if (name === 'shadowType' ||\n                    name === 'shadowColor' ||\n                    name === 'shadowBlur' ||\n                    name === 'shadowOffsetX' ||\n                    name === 'shadowOffsetY') {\n                    _this.defElementManager.createOrUpdateShadow(object, $el, name);\n                }\n                else if (name === 'filter') {\n                    _this.defElementManager.createOrUpdateFilter(object, $el, usedValue);\n                }\n                else if (name === 'anchor') {\n                    // text' anchor is controlled by `textAnchor` property\n                    if (nodeName !== Shape.TEXT) {\n                        _this.updateAnchorWithTransform(object);\n                    }\n                }\n                else {\n                    if (!isNil(computedValue)) {\n                        // use computed value so that we can use cascaded effect in SVG\n                        // ignore 'unset' and default value\n                        [$el, $hitTestingEl].forEach(function ($el) {\n                            if ($el && usedName) {\n                                if (computedValueStr !== 'unset' &&\n                                    computedValueStr !== DEFAULT_VALUE_MAP[name]) {\n                                    $el.setAttribute(usedName, formattedValueStr);\n                                }\n                                else {\n                                    $el.removeAttribute(usedName);\n                                }\n                            }\n                        });\n                    }\n                }\n            }\n        });\n    };\n    SVGRendererPlugin.prototype.createSVGDom = function (document, object, root, noWrapWithGroup) {\n        var _a;\n        if (noWrapWithGroup === void 0) { noWrapWithGroup = false; }\n        // create svg element\n        // @ts-ignore\n        object.elementSVG = new ElementSVG();\n        // @ts-ignore\n        var svgElement = object.elementSVG;\n        // use <group> as default, eg. CustomElement\n        var $el = \n        // @ts-ignore\n        this.context.SVGElementLifeCycleContribution.createElement(object, this.svgElementMap);\n        if ($el) {\n            var $groupEl = void 0;\n            // save $el on parsedStyle, which will be returned in getDomElement()\n            if (object.nodeName === Shape.HTML) {\n                object.parsedStyle.$el = $el;\n            }\n            if (this.pluginOptions.outputSVGElementId) {\n                // use user-defined id first.\n                $el.id = this.getId(object);\n            }\n            if (this.pluginOptions.outputSVGElementName && object.name) {\n                $el.setAttribute('name', object.name);\n            }\n            if (($el.hasAttribute('data-wrapgroup') || $el.nodeName !== 'g') &&\n                !noWrapWithGroup) {\n                $groupEl = createSVGElement('g', document);\n                // if (this.pluginOptions.outputSVGElementId) {\n                //   $groupEl.id = $el.id + '-g';\n                // }\n                $groupEl.appendChild($el);\n            }\n            else {\n                $groupEl = $el;\n            }\n            svgElement.$el = $el;\n            svgElement.$groupEl = $groupEl;\n            // apply attributes at first time\n            this.applyAttributes(object);\n            // create hitArea if necessary\n            this.createOrUpdateHitArea(object, $el, $groupEl);\n            var $parentGroupEl = root ||\n                // @ts-ignore\n                (object.parentNode && ((_a = object.parentNode.elementSVG) === null || _a === void 0 ? void 0 : _a.$groupEl));\n            if ($parentGroupEl) {\n                $parentGroupEl.appendChild($groupEl);\n                // need reorder children later\n                this.pendingReorderQueue.add(object.parentNode);\n            }\n        }\n    };\n    SVGRendererPlugin.prototype.removeSVGDom = function (object) {\n        var _a;\n        // @ts-ignore\n        var $groupEl = (_a = object.elementSVG) === null || _a === void 0 ? void 0 : _a.$groupEl;\n        if ($groupEl && $groupEl.parentNode) {\n            $groupEl.parentNode.removeChild($groupEl);\n            // @ts-ignore\n            this.context.SVGElementLifeCycleContribution.destroyElement(object, $groupEl);\n            // object.entity.removeComponent(ElementSVG, true);\n        }\n    };\n    SVGRendererPlugin.prototype.createOrUpdateHitArea = function (object, $el, $groupEl) {\n        var svgElement = object.elementSVG;\n        var $hitTestingEl = svgElement.$hitTestingEl;\n        var increasedLineWidthForHitTesting = Number(object.parsedStyle.increasedLineWidthForHitTesting);\n        // account for hitArea\n        if (increasedLineWidthForHitTesting) {\n            if (!$hitTestingEl) {\n                $hitTestingEl = $el.cloneNode();\n                // clear attributes like `filter` `font-size`\n                ['filter'].forEach(function (attribute) {\n                    $hitTestingEl.removeAttribute(attribute);\n                });\n                // hitArea should be 'transparent' but not 'none'\n                var hasFill = $el.getAttribute('fill') !== 'none';\n                $hitTestingEl.setAttribute('fill', hasFill ? 'transparent' : 'none');\n                $hitTestingEl.setAttribute('stroke', 'transparent');\n                $groupEl.appendChild($hitTestingEl);\n                svgElement.$hitTestingEl = $hitTestingEl;\n                // g-plugin-svg-picker will use this map to find target object\n                this.svgElementMap.set($hitTestingEl, object);\n            }\n            // increase interactive line width\n            $hitTestingEl.setAttribute('stroke-width', \"\".concat(increasedLineWidthForHitTesting + object.parsedStyle.lineWidth));\n        }\n        else {\n            if ($hitTestingEl) {\n                $groupEl.removeChild($hitTestingEl);\n                svgElement.$hitTestingEl = null;\n            }\n        }\n    };\n    SVGRendererPlugin.prototype.createOrUpdateInnerHTML = function (doc, $el, usedValue) {\n        var $div = (doc || document).createElement('div');\n        if (typeof usedValue === 'string') {\n            $div.innerHTML = usedValue;\n        }\n        else {\n            $div.appendChild(usedValue);\n        }\n        $el.innerHTML = '';\n        $el.appendChild($div);\n    };\n    SVGRendererPlugin.prototype.createOrUpdateClipOrTextPath = function (document, clipPath, object, isTextPath) {\n        if (isTextPath === void 0) { isTextPath = false; }\n        var $groupEl = object.elementSVG.$groupEl;\n        var PREFIX = isTextPath ? TEXT_PATH_PREFIX : CLIP_PATH_PREFIX;\n        var attributeNameCamel = isTextPath ? 'g' : 'clipPath';\n        var attributeNameHyphen = isTextPath ? 'text-path' : 'clip-path';\n        if (clipPath) {\n            var clipPathId = PREFIX + clipPath.entity + '-' + object.entity;\n            var $def = this.defElementManager.getDefElement();\n            var existed = $def.querySelector(\"#\".concat(clipPathId));\n            if (!existed) {\n                var $clipPath = void 0;\n                if (isTextPath) {\n                    // use <path> directly instead of wrapping with <g>\n                    this.createSVGDom(document, clipPath, null, true);\n                    // @ts-ignore\n                    $clipPath = clipPath.elementSVG.$el;\n                }\n                else {\n                    // the clipPath is allowed to be detached from canvas\n                    if (!clipPath.isConnected) {\n                        var $existedClipPath = $def.querySelector(\"#\".concat(this.getId(clipPath)));\n                        if (!$existedClipPath) {\n                            this.createSVGDom(document, clipPath, $def, true);\n                        }\n                    }\n                    // create <clipPath> dom node\n                    $clipPath = createSVGElement(attributeNameCamel, document);\n                    var $use = createSVGElement('use', document);\n                    // @ts-ignore\n                    $use.setAttribute('href', \"#\".concat(clipPath.elementSVG.$el.id));\n                    $clipPath.appendChild($use);\n                    var $useRefs = this.clipPathUseMap.get(clipPath);\n                    if (!$useRefs) {\n                        this.clipPathUseMap.set(clipPath, []);\n                        $useRefs = this.clipPathUseMap.get(clipPath);\n                    }\n                    $useRefs.push($use);\n                    // <clipPath transform=\"matrix()\"><circle /></clipPath>\n                    this.applyTransform($use, clipPath.getWorldTransform());\n                    var parentInvert = mat4.invert(mat4.create(), object.getWorldTransform());\n                    this.applyTransform($clipPath, parentInvert);\n                }\n                if (this.pluginOptions.outputSVGElementId) {\n                    $clipPath.id = clipPathId;\n                }\n                // append it to <defs>\n                $def.appendChild($clipPath);\n            }\n            // apply attributes\n            this.applyAttributes(clipPath);\n            if (!isTextPath) {\n                // apply clipPath to $group\n                // @see https://github.com/antvis/g/issues/961\n                $groupEl.setAttribute(attributeNameHyphen, \"url(#\".concat(clipPathId, \")\"));\n            }\n        }\n        else {\n            if (!isTextPath) {\n                // remove clip path\n                $groupEl.removeAttribute(attributeNameHyphen);\n            }\n        }\n    };\n    /**\n     * the origin is bounding box's top left corner\n     */\n    SVGRendererPlugin.prototype.updateAnchorWithTransform = function (object) {\n        var _a, _b;\n        var bounds = object.getGeometryBounds();\n        var width = (bounds && bounds.halfExtents[0] * 2) || 0;\n        var height = (bounds && bounds.halfExtents[1] * 2) || 0;\n        var anchor = (object.parsedStyle || {}).anchor;\n        [\n            (_a = object.elementSVG) === null || _a === void 0 ? void 0 : _a.$el,\n            (_b = object.elementSVG) === null || _b === void 0 ? void 0 : _b.$hitTestingEl,\n        ].forEach(function ($el) {\n            if ($el) {\n                var tx = -(anchor[0] * width);\n                var ty = -(anchor[1] * height);\n                if (tx !== 0 || ty !== 0) {\n                    // apply anchor to element's `transform` property\n                    $el.setAttribute('transform', \n                    // can't use percent unit like translate(-50%, -50%)\n                    // @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Attribute/transform#translate\n                    \"translate(\".concat(tx, \",\").concat(ty, \")\"));\n                }\n                if (object.nodeName === Shape.CIRCLE ||\n                    object.nodeName === Shape.ELLIPSE) {\n                    $el.setAttribute('cx', \"\".concat(width / 2));\n                    $el.setAttribute('cy', \"\".concat(height / 2));\n                }\n            }\n        });\n    };\n    SVGRendererPlugin.tag = 'SVGRenderer';\n    return SVGRendererPlugin;\n}());\n\n// @see https://github.com/plouc/nivo/issues/164\nvar BASELINE_MAP = {\n    top: 'hanging', // Use hanging here.\n    middle: 'central',\n    bottom: 'text-after-edge', // FIXME: It is not a standard property.\n    alphabetic: 'alphabetic',\n    ideographic: 'ideographic',\n    hanging: 'hanging',\n};\nfunction updateTextElementAttribute($el, parsedStyle, text, runtime) {\n    var lineWidth = parsedStyle.lineWidth, dx = parsedStyle.dx, dy = parsedStyle.dy, textPath = parsedStyle.textPath, _a = parsedStyle.textPathSide, textPathSide = _a === void 0 ? 'left' : _a, _b = parsedStyle.textPathStartOffset, textPathStartOffset = _b === void 0 ? 0 : _b, _c = parsedStyle.textDecorationLine, textDecorationLine = _c === void 0 ? '' : _c, _d = parsedStyle.textDecorationColor, textDecorationColor = _d === void 0 ? '' : _d, _e = parsedStyle.textDecorationStyle, textDecorationStyle = _e === void 0 ? '' : _e, metrics = parsedStyle.metrics;\n    var textBaseline = parsedStyle.textBaseline;\n    if (!runtime.enableCSSParsing && textBaseline === 'alphabetic') {\n        textBaseline = 'bottom';\n    }\n    $el.setAttribute('dominant-baseline', BASELINE_MAP[textBaseline]);\n    $el.setAttribute('paint-order', 'stroke');\n    var lines = metrics.lines, lineHeight = metrics.lineHeight, height = metrics.height;\n    var lineNum = lines.length;\n    var styleCSSText = '';\n    if (dx !== 0 || dy !== 0) {\n        styleCSSText += \"transform:translate(\".concat(dx, \"px, \").concat(dy, \"px);\");\n    }\n    if (textDecorationLine && textDecorationLine !== 'none') {\n        // use CSS text-decoration since the implementation in SVG is not good enough\n        styleCSSText += \"text-decoration:\".concat(textDecorationLine, \" \").concat(textDecorationStyle, \" \").concat(textDecorationColor, \";\");\n    }\n    if (styleCSSText) {\n        $el.setAttribute('style', styleCSSText);\n    }\n    if (lineNum === 1) {\n        var textContent = convertHTML(lines[0]);\n        $el.setAttribute('dx', \"\".concat(lineWidth / 2));\n        // Since `text-after-edge` is not a standard property value, we use `dy` instead.\n        if (textBaseline === 'bottom' || textBaseline === 'top') {\n            $el.setAttribute('dominant-baseline', BASELINE_MAP['middle']);\n            $el.setAttribute('dy', textBaseline === 'bottom' ? \"-\".concat(height / 2, \"px\") : \"\".concat(height / 2, \"px\"));\n        }\n        // <textPath> only support one line\n        // @see https://developer.mozilla.org/en-US/docs/Web/SVG/Element/textPath\n        if (textPath) {\n            // clear existed text content first\n            $el.innerHTML = '';\n            // append <textPath href=\"#MyPath\">text</textPath>\n            var $textPath = createSVGElement('textPath', $el.ownerDocument);\n            $textPath.setAttribute('href', \"#\".concat(TEXT_PATH_PREFIX + textPath.entity));\n            if (textPathSide !== 'left') {\n                $textPath.setAttribute('side', textPathSide);\n            }\n            if (textPathStartOffset !== 0) {\n                $textPath.setAttribute('startOffset', \"\".concat(textPathStartOffset));\n            }\n            $textPath.innerHTML = textContent;\n            $el.appendChild($textPath);\n        }\n        else {\n            $el.innerHTML = textContent;\n        }\n    }\n    else {\n        $el.innerHTML = lines\n            .map(function (line, i) {\n            var dx = lineWidth / 2;\n            var dy = 0;\n            if (i === 0) {\n                // TODO: handle other textBaseline values\n                if (textBaseline === 'middle') {\n                    dy = lineHeight / 2 - height / 2;\n                }\n                else if (textBaseline === 'top' || textBaseline === 'hanging') {\n                    dy = 0;\n                }\n                else if (textBaseline === 'bottom' ||\n                    textBaseline === 'alphabetic' ||\n                    textBaseline === 'ideographic') {\n                    dy = -lineHeight * (lineNum - 1);\n                }\n            }\n            else {\n                dy = lineHeight;\n            }\n            return \"<tspan x=\\\"0\\\" dx=\\\"\".concat(dx, \"\\\" dy=\\\"\").concat(dy, \"\\\">\").concat(convertHTML(line), \"</tspan>\");\n        })\n            .join('');\n    }\n}\n\nvar _a, _b;\nvar SHAPE2TAGS = (_a = {},\n    _a[Shape.RECT] = 'path',\n    _a[Shape.CIRCLE] = 'circle',\n    _a[Shape.ELLIPSE] = 'ellipse',\n    _a[Shape.IMAGE] = 'image',\n    _a[Shape.GROUP] = 'g',\n    _a[Shape.LINE] = 'line',\n    _a[Shape.POLYLINE] = 'polyline',\n    _a[Shape.POLYGON] = 'polygon',\n    _a[Shape.TEXT] = 'text',\n    _a[Shape.PATH] = 'path',\n    _a[Shape.HTML] = 'foreignObject',\n    _a);\nvar SHAPE_UPDATE_DEPS = (_b = {},\n    _b[Shape.CIRCLE] = ['r'],\n    _b[Shape.ELLIPSE] = ['rx', 'ry'],\n    _b[Shape.RECT] = ['width', 'height', 'radius'],\n    _b[Shape.IMAGE] = ['img', 'width', 'height'],\n    _b[Shape.LINE] = [\n        'x1',\n        'y1',\n        'x2',\n        'y2',\n        'markerStart',\n        'markerEnd',\n        'markerStartOffset',\n        'markerEndOffset',\n    ],\n    _b[Shape.POLYLINE] = [\n        'points',\n        'markerStart',\n        'markerEnd',\n        'markerMid',\n        'markerStartOffset',\n        'markerEndOffset',\n    ],\n    _b[Shape.POLYGON] = [\n        'points',\n        'markerStart',\n        'markerEnd',\n        'markerMid',\n        'markerStartOffset',\n        'markerEndOffset',\n    ],\n    _b[Shape.PATH] = [\n        'path',\n        'markerStart',\n        'markerEnd',\n        'markerMid',\n        'markerStartOffset',\n        'markerEndOffset',\n    ],\n    _b[Shape.TEXT] = [\n        'text',\n        'font',\n        'fontSize',\n        'fontFamily',\n        'fontStyle',\n        'fontWeight',\n        'fontVariant',\n        'lineHeight',\n        'letterSpacing',\n        'wordWrap',\n        'wordWrapWidth',\n        'maxLines',\n        'leading',\n        'textBaseline',\n        'textAlign',\n        'textTransform',\n        'textOverflow',\n        'textPath',\n        'textPathSide',\n        'textPathStartOffset',\n        'textDecorationLine',\n        'textDecorationColor',\n        'textDecorationStyle',\n        // 'whiteSpace',\n        'dx',\n        'dy',\n    ],\n    _b);\nvar DefaultElementLifeCycleContribution = /** @class */ (function () {\n    function DefaultElementLifeCycleContribution(context, runtime) {\n        this.context = context;\n        this.runtime = runtime;\n    }\n    DefaultElementLifeCycleContribution.prototype.createElement = function (object, svgElementMap) {\n        var doc = this.context.config.document;\n        var type = SHAPE2TAGS[object.nodeName] || 'g';\n        var $el = createSVGElement(type, doc || document);\n        svgElementMap.set($el, object);\n        return $el;\n    };\n    DefaultElementLifeCycleContribution.prototype.destroyElement = function (object, $el) { };\n    DefaultElementLifeCycleContribution.prototype.shouldUpdateElementAttribute = function (object, attributeName) {\n        var nodeName = object.nodeName;\n        return (SHAPE_UPDATE_DEPS[nodeName] || []).indexOf(attributeName) > -1;\n    };\n    DefaultElementLifeCycleContribution.prototype.updateElementAttribute = function (object) {\n        // @ts-ignore\n        var $el = object.elementSVG.$el;\n        var nodeName = object.nodeName, parsedStyle = object.parsedStyle;\n        switch (nodeName) {\n            case Shape.IMAGE: {\n                updateImageElementAttribute($el, parsedStyle);\n                break;\n            }\n            case Shape.RECT: {\n                updateRectElementAttribute($el, parsedStyle);\n                break;\n            }\n            case Shape.LINE: {\n                updateLineElementAttribute($el, parsedStyle);\n                break;\n            }\n            case Shape.POLYGON:\n            case Shape.POLYLINE: {\n                updatePolylineElementAttribute($el, parsedStyle);\n                break;\n            }\n            case Shape.PATH: {\n                updatePathElementAttribute($el, parsedStyle);\n                break;\n            }\n            case Shape.TEXT: {\n                updateTextElementAttribute($el, parsedStyle, object, this.runtime);\n                break;\n            }\n        }\n    };\n    return DefaultElementLifeCycleContribution;\n}());\n\nvar Plugin = /** @class */ (function (_super) {\n    __extends(Plugin, _super);\n    function Plugin(options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this) || this;\n        _this.options = options;\n        _this.name = 'svg-renderer';\n        return _this;\n    }\n    Plugin.prototype.init = function (runtime) {\n        var _a = this.options, outputSVGElementId = _a.outputSVGElementId, outputSVGElementName = _a.outputSVGElementName;\n        var defElementManager = new DefElementManager(this.context);\n        // default implementation\n        var defaultElementLifeCycleContribution = new DefaultElementLifeCycleContribution(this.context, runtime);\n        // @ts-ignore\n        this.context.defaultElementLifeCycleContribution =\n            defaultElementLifeCycleContribution;\n        // @ts-ignore\n        this.context.SVGElementLifeCycleContribution =\n            defaultElementLifeCycleContribution;\n        var SVGRendererPluginOptions = {\n            outputSVGElementId: !isNil(outputSVGElementId)\n                ? !!outputSVGElementId\n                : true,\n            outputSVGElementName: !isNil(outputSVGElementName)\n                ? !!outputSVGElementName\n                : true,\n        };\n        this.addRenderingPlugin(\n        // @ts-ignore\n        new SVGRendererPlugin(SVGRendererPluginOptions, defElementManager, this.context));\n    };\n    Plugin.prototype.destroy = function () {\n        this.removeAllRenderingPlugins();\n        // @ts-ignore\n        delete this.context.defaultElementLifeCycleContribution;\n        // @ts-ignore\n        delete this.context.SVGElementLifeCycleContribution;\n    };\n    return Plugin;\n}(AbstractRendererPlugin));\n\nexport { CLIP_PATH_PREFIX, DEFAULT_VALUE_MAP, DefaultElementLifeCycleContribution, ElementSVG, G_SVG_PREFIX, Plugin, SHAPE2TAGS, SHAPE_UPDATE_DEPS, SVGRendererPlugin, SVG_ATTR_MAP, TEXT_PATH_PREFIX, createSVGElement, updateImageElementAttribute, updateLineElementAttribute, updatePathElementAttribute, updatePolylineElementAttribute, updateRectElementAttribute, updateTextElementAttribute };\n//# sourceMappingURL=index.esm.js.map\n","import { __spreadArray, __read, __extends, __assign } from 'tslib';\nimport { AbstractRendererPlugin } from '@antv/g-lite';\n\n/**\n * TODO: use clock from g later.\n */\nvar clock = typeof performance === 'object' && performance.now ? performance : Date;\n// 计算滑动的方向\nvar calcDirection = function (start, end) {\n    var xDistance = end.x - start.x;\n    var yDistance = end.y - start.y;\n    // x 的距离大于y 说明是横向，否则就是纵向\n    if (Math.abs(xDistance) > Math.abs(yDistance)) {\n        return xDistance > 0 ? 'right' : 'left';\n    }\n    return yDistance > 0 ? 'down' : 'up';\n};\n// 计算2点之间的距离\nvar calcDistance = function (point1, point2) {\n    var xDistance = Math.abs(point2.x - point1.x);\n    var yDistance = Math.abs(point2.y - point1.y);\n    return Math.sqrt(xDistance * xDistance + yDistance * yDistance);\n};\nvar getCenter = function (point1, point2) {\n    var x = point1.x + (point2.x - point1.x) / 2;\n    var y = point1.y + (point2.y - point1.y) / 2;\n    return { x: x, y: y };\n};\n\nvar PRESS_DELAY = 250;\nvar GesturePlugin = /** @class */ (function () {\n    function GesturePlugin(options) {\n        var _this = this;\n        this.options = options;\n        this.evCache = [];\n        this.startPoints = [];\n        // 用来记录当前触发的事件\n        this.processEvent = {};\n        this.throttleTimer = 0;\n        this.emitThrottles = [];\n        this._start = function (ev, target) {\n            var _a;\n            // 每次触点开始都重置事件\n            _this.reset();\n            // 记录touch start 的时间\n            _this.startTime = clock.now();\n            var _b = _this, evCache = _b.evCache, startPoints = _b.startPoints;\n            if (ev) {\n                var pointerId_1 = ev.pointerId, x = ev.x, y = ev.y;\n                // evcache 已经存在的 pointerId, 做替换\n                var existIdx = evCache.findIndex(function (item) { return pointerId_1 === item.pointerId; });\n                if (existIdx !== -1) {\n                    evCache.splice(existIdx, 1);\n                }\n                // evCache 不存在的 pointerId, 添加\n                evCache.push({\n                    pointerId: pointerId_1,\n                    x: x,\n                    y: y,\n                    ev: ev,\n                });\n                // @ts-ignore 对齐touches evCache 存在，touches 不存在，移除\n                var evTouches = __spreadArray([], __read((((_a = ev.nativeEvent) === null || _a === void 0 ? void 0 : _a.touches) || [])), false);\n                var _loop_1 = function (i) {\n                    var isInTouches = evTouches.find(function (touch) {\n                        return evCache[i].pointerId === touch.identifier;\n                    });\n                    // 在touches中存在\n                    if (isInTouches) {\n                        return \"continue\";\n                    }\n                    // 在touches中不存在\n                    evCache.splice(i, 1);\n                };\n                for (var i = evCache.length - 1; i > -1; i--) {\n                    _loop_1(i);\n                }\n            }\n            // 重置 startPoints\n            startPoints.length = evCache.length;\n            for (var i = 0; i < evCache.length; i++) {\n                var _c = evCache[i], x = _c.x, y = _c.y;\n                var point = { x: x, y: y };\n                startPoints[i] = point;\n            }\n            // 单指事件\n            if (startPoints.length === 1) {\n                var event_1 = evCache[0].ev;\n                // 如果touchstart后停顿250ms, 则也触发press事件\n                // @ts-ignore\n                _this.pressTimeout = setTimeout(function () {\n                    // 这里固定触发press事件\n                    var eventType = 'press';\n                    var direction = 'none';\n                    event_1.direction = direction;\n                    event_1.deltaX = 0;\n                    event_1.deltaY = 0;\n                    event_1.points = startPoints;\n                    _this.emitStart(eventType, event_1, target);\n                    event_1.type = eventType;\n                    target.dispatchEvent(event_1);\n                    _this.eventType = eventType;\n                    _this.direction = direction;\n                    _this.movingTarget = target;\n                }, PRESS_DELAY);\n                return;\n            }\n            // 目前只处理双指\n            _this.startDistance = calcDistance(startPoints[0], startPoints[1]);\n            _this.center = getCenter(startPoints[0], startPoints[1]);\n        };\n        this._move = function (ev, target) {\n            _this.clearPressTimeout();\n            var _a = _this, startPoints = _a.startPoints, evCache = _a.evCache;\n            if (!startPoints.length)\n                return;\n            var x = ev.x, y = ev.y, pointerId = ev.pointerId;\n            // Find this event in the cache and update its record with this event\n            for (var i = 0, len = evCache.length; i < len; i++) {\n                if (pointerId === evCache[i].pointerId) {\n                    evCache[i] = {\n                        pointerId: pointerId,\n                        x: x,\n                        y: y,\n                        ev: ev,\n                    };\n                    break;\n                }\n            }\n            var point = { x: x, y: y };\n            var points = evCache.map(function (ev) {\n                return { x: ev.x, y: ev.y };\n            });\n            // 记录最后2次move的时间和坐标，为了给swipe事件用\n            var now = clock.now();\n            _this.prevMoveTime = _this.lastMoveTime;\n            _this.prevMovePoint = _this.lastMovePoint;\n            _this.lastMoveTime = now;\n            _this.lastMovePoint = point;\n            if (startPoints.length === 1) {\n                var startPoint = startPoints[0];\n                var deltaX = x - startPoint.x;\n                var deltaY = y - startPoint.y;\n                var direction = _this.direction || calcDirection(startPoint, point);\n                _this.direction = direction;\n                // 获取press或者pan的事件类型\n                // press 按住滑动, pan表示平移\n                // 如果start后立刻move，则触发pan, 如果有停顿，则触发press\n                var eventType = _this.getEventType(point, target, ev);\n                ev.direction = direction;\n                ev.deltaX = deltaX;\n                ev.deltaY = deltaY;\n                ev.points = points;\n                _this.emitStart(eventType, ev, target);\n                ev.type = eventType;\n                _this.refreshAndGetTarget(target).dispatchEvent(ev);\n                return;\n            }\n            // 多指触控\n            var startDistance = _this.startDistance;\n            var currentDistance = calcDistance(points[0], points[1]);\n            // 缩放比例\n            ev.zoom = currentDistance / startDistance;\n            ev.center = _this.center;\n            ev.points = points;\n            // 触发缩放事件\n            _this.emitStart('pinch', ev, target);\n            // touch 多指会被拆成多个手指的 move, 会触发多次 move，所以这里需要做节流\n            _this._throttleEmit('pinch', ev, target);\n        };\n        this._end = function (ev, target) {\n            var _a = _this, evCache = _a.evCache, startPoints = _a.startPoints;\n            var points = evCache.map(function (ev) {\n                return { x: ev.x, y: ev.y };\n            });\n            ev.points = points;\n            _this.emitEnd(ev, _this.refreshAndGetTarget(target));\n            // 单指\n            if (evCache.length === 1) {\n                // swipe事件处理, 在end之后触发\n                var now = clock.now();\n                var lastMoveTime = _this.lastMoveTime;\n                // 做这个判断是为了最后一次touchmove后到end前，是否还有一个停顿的过程\n                // 100 是拍的一个值，理论这个值会很短，一般不卡顿的话在10ms以内\n                if (now - lastMoveTime < 100) {\n                    var prevMoveTime = _this.prevMoveTime || _this.startTime;\n                    var intervalTime = lastMoveTime - prevMoveTime;\n                    // 时间间隔一定要大于0, 否则计算没意义\n                    if (intervalTime > 0) {\n                        var prevMovePoint = _this.prevMovePoint || startPoints[0];\n                        var lastMovePoint = _this.lastMovePoint || startPoints[0];\n                        // move速率\n                        var velocity = calcDistance(prevMovePoint, lastMovePoint) / intervalTime;\n                        // 0.3 是参考hammerjs的设置\n                        if (velocity > 0.3) {\n                            ev.velocity = velocity;\n                            ev.direction = calcDirection(prevMovePoint, lastMovePoint);\n                            ev.type = 'swipe';\n                            target.dispatchEvent(ev);\n                        }\n                    }\n                }\n            }\n            // remove event from cache\n            for (var i = 0, len = evCache.length; i < len; i++) {\n                if (evCache[i].pointerId === ev.pointerId) {\n                    evCache.splice(i, 1);\n                    startPoints.splice(i, 1);\n                    break;\n                }\n            }\n            _this.reset();\n            // 多指离开 1 指后，重新触发一次start\n            if (evCache.length > 0) {\n                _this._start(undefined, target);\n            }\n        };\n        this._cancel = function (ev, target) {\n            var evCache = _this.evCache;\n            var points = evCache.map(function (ev) {\n                return { x: ev.x, y: ev.y };\n            });\n            ev.points = points;\n            _this.emitEnd(ev, _this.refreshAndGetTarget(target));\n            _this.evCache = [];\n            _this.reset();\n        };\n    }\n    GesturePlugin.prototype.apply = function (context) {\n        var _this = this;\n        var renderingService = context.renderingService, renderingContext = context.renderingContext;\n        var document = renderingContext.root.ownerDocument;\n        var canvas = document.defaultView;\n        this.canvas = canvas;\n        var getGestureEventTarget = function (target) {\n            var isDocument = target === document;\n            return isDocument && _this.options.isDocumentGestureEnabled\n                ? document\n                : target;\n        };\n        var handlePointermove = function (ev) {\n            var target = getGestureEventTarget(ev.target);\n            target && _this._move(ev, target);\n        };\n        var handlePointerdown = function (ev) {\n            var target = getGestureEventTarget(ev.target);\n            target && _this._start(ev, target);\n        };\n        var handlePointerup = function (ev) {\n            var target = getGestureEventTarget(ev.target);\n            target && _this._end(ev, target);\n        };\n        var handlePointercancel = function (ev) {\n            var target = getGestureEventTarget(ev.target);\n            target && _this._cancel(ev, target);\n        };\n        var handlePointercanceloutside = function (ev) {\n            var target = getGestureEventTarget(ev.target);\n            target && _this._end(ev, target);\n        };\n        renderingService.hooks.init.tap(GesturePlugin.tag, function () {\n            canvas.addEventListener('pointermove', handlePointermove);\n            canvas.addEventListener('pointerdown', handlePointerdown);\n            canvas.addEventListener('pointerup', handlePointerup);\n            canvas.addEventListener('pointercancel', handlePointercancel);\n            canvas.addEventListener('pointerupoutside', handlePointercanceloutside);\n        });\n        renderingService.hooks.destroy.tap(GesturePlugin.tag, function () {\n            canvas.removeEventListener('pointermove', handlePointermove);\n            canvas.removeEventListener('pointerdown', handlePointerdown);\n            canvas.removeEventListener('pointerup', handlePointerup);\n            canvas.removeEventListener('pointercancel', handlePointercancel);\n            canvas.removeEventListener('pointerupoutside', handlePointercanceloutside);\n        });\n    };\n    GesturePlugin.prototype.getEventType = function (point, target, ev) {\n        var _a = this, eventType = _a.eventType, startTime = _a.startTime, startPoints = _a.startPoints;\n        if (eventType) {\n            return eventType;\n        }\n        // move的时候缓存节点，后续move和end都会使用这个target派发事件\n        this.movingTarget = target;\n        // 冒泡路径中是否有pan事件\n        this.isPanListenerInPath = ev.path.some(function (ele) { var _a, _b; return !!((_b = (_a = ele.emitter) === null || _a === void 0 ? void 0 : _a.eventNames()) === null || _b === void 0 ? void 0 : _b.includes('pan')); });\n        var type;\n        // 如果没有pan事件的监听，默认都是press\n        if (!this.isPanListenerInPath) {\n            type = 'press';\n        }\n        else {\n            // 如果有pan事件的处理，press则需要停顿250ms, 且移动距离小于10\n            var now = clock.now();\n            if (now - startTime > PRESS_DELAY &&\n                calcDistance(startPoints[0], point) < 10) {\n                type = 'press';\n            }\n            else {\n                type = 'pan';\n            }\n        }\n        this.eventType = type;\n        return type;\n    };\n    GesturePlugin.prototype.enable = function (eventType) {\n        this.processEvent[eventType] = true;\n    };\n    // 是否进行中的事件\n    GesturePlugin.prototype.isProcess = function (eventType) {\n        return this.processEvent[eventType];\n    };\n    // 触发start事件\n    GesturePlugin.prototype.emitStart = function (type, ev, target) {\n        if (this.isProcess(type)) {\n            return;\n        }\n        this.enable(type);\n        ev.type = \"\".concat(type, \"start\");\n        target.dispatchEvent(ev);\n    };\n    // 触发事件\n    GesturePlugin.prototype._throttleEmit = function (type, ev, target) {\n        var _this = this;\n        // 主要是节流处理\n        this.pushEvent(type, ev);\n        var _a = this, throttleTimer = _a.throttleTimer, emitThrottles = _a.emitThrottles, processEvent = _a.processEvent;\n        if (throttleTimer) {\n            return;\n        }\n        this.throttleTimer = this.canvas.requestAnimationFrame(function () {\n            for (var i = 0, len = emitThrottles.length; i < len; i++) {\n                var _a = emitThrottles[i], type_1 = _a.type, ev_1 = _a.ev;\n                if (processEvent[type_1]) {\n                    ev_1.type = type_1;\n                    target.dispatchEvent(ev_1);\n                }\n            }\n            // 清空\n            _this.throttleTimer = 0;\n            _this.emitThrottles.length = 0;\n        });\n    };\n    // 触发end事件\n    GesturePlugin.prototype.emitEnd = function (ev, target) {\n        var processEvent = this.processEvent;\n        Object.keys(processEvent).forEach(function (type) {\n            ev.type = \"\".concat(type, \"end\");\n            target.dispatchEvent(ev);\n            delete processEvent[type];\n        });\n    };\n    GesturePlugin.prototype.pushEvent = function (type, ev) {\n        var emitThrottles = this.emitThrottles;\n        var newEvent = { type: type, ev: ev };\n        for (var i = 0, len = emitThrottles.length; i < len; i++) {\n            if (emitThrottles[i].type === type) {\n                emitThrottles.splice(i, 1, newEvent);\n                return;\n            }\n        }\n        emitThrottles.push(newEvent);\n    };\n    GesturePlugin.prototype.clearPressTimeout = function () {\n        if (this.pressTimeout) {\n            clearTimeout(this.pressTimeout);\n            this.pressTimeout = null;\n        }\n    };\n    GesturePlugin.prototype.refreshAndGetTarget = function (target) {\n        if (this.movingTarget) {\n            // @ts-ignore\n            if (this.movingTarget && !this.movingTarget.isConnected) {\n                this.movingTarget = target;\n            }\n            return this.movingTarget;\n        }\n        return target;\n    };\n    GesturePlugin.prototype.reset = function () {\n        this.clearPressTimeout();\n        this.startTime = 0;\n        this.startDistance = 0;\n        this.direction = null;\n        this.eventType = null;\n        this.prevMoveTime = 0;\n        this.prevMovePoint = null;\n        this.lastMoveTime = 0;\n        this.lastMovePoint = null;\n        this.movingTarget = null;\n        this.isPanListenerInPath = null;\n    };\n    GesturePlugin.tag = 'Gesture';\n    return GesturePlugin;\n}());\n\nvar Plugin = /** @class */ (function (_super) {\n    __extends(Plugin, _super);\n    function Plugin(options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this) || this;\n        _this.options = options;\n        _this.name = 'gesture';\n        return _this;\n    }\n    Plugin.prototype.init = function () {\n        this.addRenderingPlugin(new GesturePlugin(__assign({ isDocumentGestureEnabled: false }, this.options)));\n    };\n    Plugin.prototype.destroy = function () {\n        this.removeAllRenderingPlugins();\n    };\n    return Plugin;\n}(AbstractRendererPlugin));\n\nexport { Plugin };\n//# sourceMappingURL=index.esm.js.map\n",null,null,null],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","__","this","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","pop","push","__read","o","m","r","ar","error","__spreadArray","to","from","pack","l","slice","concat","ARRAY_TYPE","Float32Array","out","glMatrix.ARRAY_TYPE","invert","a","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","Math","hypot","sqrt","isNil$1","toString","isType$1","type","isString","str","isType","clamp$1","min","max","DragndropPlugin","dragndropPluginOptions","context","_this","renderingService","document","renderingContext","root","ownerDocument","canvas","defaultView","handlePointerdown","event","target","isDocument","draggableEventTarget","isDocumentDraggable","closest","dragstartTriggered_1","dragstartTimeStamp_1","timeStamp","dragstartClientCoordinates_1","clientX","clientY","currentDroppable_1","lastDragClientCoordinates_1","handlePointermove_1","timeElapsed","distanceMoved","point","elementsBelow","elementBelow","droppableBelow","_a","dragstartTimeThreshold","dragstartDistanceThreshold","dispatchEvent","dx","dy","overlap","canvasX","canvasY","getBounds","center","elementsFromPoint","indexOf","isDocumentDroppable","addEventListener","stopDragging","originalPointerUpEvent","detail","preventClick","event_1","clone","removeEventListener","once","hooks","init","tap","tag","destroy","Plugin","_super","options","name","addRenderingPlugin","removeAllRenderingPlugins","setOptions","plugins","AbstractRendererPlugin","MobileInteractionPlugin","config","canvasEl","contextService","getDomElement","onPointerDown","ev","pointerDown","onPointerUp","pointerUp","onPointerMove","pointerMove","onPointerOver","pointerOver","onPointerOut","pointerOut","onClick","click","onPointerCancel","pointerCancel","useNativeClickEvent","SVGPickerPlugin","runtime","doc","svgElementMap","pick","tapPromise","pickSync","e_1","topmost","_b","position","targets","_c","__values","_d","element","shadowRoot","get","isInteractive","picked","e_1_1","ElementSVG","updateImageElementAttribute","$el","parsedStyle","img","width","height","setAttribute","Image","src","HTMLElement","nodeName","toUpperCase","toDataURL","ImageData","createElement","getContext","putImageData","updateLineElementAttribute","x1","y1","x2","y2","defX","defY","markerStart","markerEnd","markerStartOffset","markerEndOffset","startOffsetX","startOffsetY","endOffsetX","endOffsetY","rad","isDisplayObject","cos","atan2","sin","updatePathElementAttribute","path","parentNode","getStartTangent","p1","p2","getEndTangent","translatePathToString","absolutePath","updatePolylineElementAttribute","points","startOffsetX_1","startOffsetY_1","endOffsetX_1","endOffsetY_1","map","offsetX","offsetY","join","updateRectElementAttribute","radius","isFinite","some","clamp","abs","tlr","trr","brr","blr","signX","signY","sweepFlag","createSVGElement","createElementNS","FILTER_PREFIX","createOrUpdateFilter","$def","object","filters","filterName","entity","$existedFilters","querySelectorAll","forEach","$filter","removeChild","removeAttribute","filterIds_1","params","$feGaussianBlur","appendChild","createBlur","slope","convertToAbsoluteValue","createFeComponentTransfer","intercept","createBrightness","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","formatted","$feOffset","$feFlood","$feComposite","$feMerge","$feMergeNode1","$feMergeNode2","createDropShadow","createContrast","amount","createFeColorMatrix","createGrayscale","createSepia","$feColorMatrix","createSaturate","createHueRotate","tableValues","createInvert","id","setTimeout","filterId","param","unit","UnitType","kPercentage","$feComponentTransfer","$feFunc","matrix","PATTERN_PREFIX","cacheKey2IDMap","counter","createOrUpdateGradientAndPattern","parsedColor","createImage","plugin","isCSSRGB","isPattern","patternId","pattern","generateCacheKey","$existed","querySelector","image","imageURL","isBrowser","HTMLImageElement","HTMLCanvasElement","img_1","$image_1","window","match","crossOrigin","onload_1","$pattern","create$Pattern","complete","onload","createSVGDom","svgElement","elementSVG","localTransform","getLocalTransform","applyTransform","$groupEl","createOrUpdatePattern","style","gradientId","createOrUpdateGradient","gradients","blended","gradient","rectId","$rect","$feImage","$feBlend","createOrUpdateMultiGradient","isNone","cacheKey","isCSSGradientValue","GradientType","LinearGradient","RadialGradient","steps","angle","cx","cy","size","color","offset","repetition","transform","parseTransform","parsed","newScale","newSkew","c","dd","tx","ty","formatTransform","halfExtents","getGeometryBounds","patternWidth","patternHeight","bounds","innerHTML_1","sort","innerHTML","computeLinearGradient","computeRadialGradient","x","urlRegexp","DefElementManager","gradientCache","getDefElement","$svg","clear","keys","clearUnusedDefElement","cache","has","targetElement","matches","getAttribute","replace","newDefElementId","Set","add","createOrUpdateShadow","shadowType","hasShadow","isNil","shadowId","$existedFilter","remove","$feDropShadow","$feFuncA","$feComposite2","$feMergeNode","children","numberToLongString","toFixed","convertHTML","SVG_ATTR_MAP","opacity","fillStyle","fill","fillRule","fillOpacity","strokeStyle","strokeOpacity","stroke","clipPath","textPath","rx","ry","lineCap","lineJoin","lineWidth","lineDash","lineDashOffset","miterLimit","font","fontSize","fontStyle","fontVariant","fontWeight","fontFamily","letterSpacing","startArrow","endArrow","class","preserveAspectRatio","visibility","anchor","filter","textAlign","pointerEvents","FORMAT_VALUE_MAP","inherit","left","start","right","end","DEFAULT_VALUE_MAP","strokeWidth","strokeMiterLimit","G_SVG_PREFIX","CLIP_PATH_PREFIX","TEXT_PATH_PREFIX","SVGRendererPlugin","pluginOptions","defElementManager","WeakMap","renderQueue","dirtyAttributes","pendingReorderQueue","clipPathUseMap","handleMounted","existed","getId","$camera","handleUnmounted","delete","removeSVGDom","reorderChildren","parent","handleReparent","handleAttributeChanged","attrName","attribtues","set","handleGeometryBoundsChanged","parentInvert","mat4.invert","mat4.create","getWorldTransform","clipPathId","background","camera","getOrthoMatrix","ElementEvent","MOUNTED","UNMOUNTED","REPARENT","ATTR_MODIFIED","BOUNDS_CHANGED","render","beginFrame","$parentGroupEl","endFrame","renderReasons","RenderReason","CAMERA_CHANGED","$useRefs","$use","renderable","dirty","attributes","createOrUpdateHitArea","updateAttribute","sortable","renderOrder","fragment_1","createDocumentFragment","child","isConnected","rts","applyAttributes","Shape","HTML","IMAGE","enableCSSParsing","$hitTestingEl","computedStyle","SVGElementLifeCycleContribution","shouldUpdateElementAttribute","updateElementAttribute","TEXT","updateAnchorWithTransform","usedName","computedValue","computedValueStr","formattedValueStr","usedValue","inherited","propertyMetadataCache","inh","createOrUpdateInnerHTML","GROUP","isCustomElement","createOrUpdateClipOrTextPath","noWrapWithGroup","outputSVGElementId","outputSVGElementName","hasAttribute","destroyElement","increasedLineWidthForHitTesting","Number","cloneNode","attribute","hasFill","$div","isTextPath","attributeNameCamel","attributeNameHyphen","$clipPath","CIRCLE","ELLIPSE","BASELINE_MAP","top","middle","bottom","alphabetic","ideographic","hanging","updateTextElementAttribute","text","textPathSide","textPathStartOffset","textDecorationLine","textDecorationColor","_e","textDecorationStyle","metrics","textBaseline","lines","lineHeight","lineNum","styleCSSText","textContent","$textPath","line","SHAPE2TAGS","RECT","LINE","POLYLINE","POLYGON","PATH","SHAPE_UPDATE_DEPS","DefaultElementLifeCycleContribution","attributeName","defaultElementLifeCycleContribution","SVGRendererPluginOptions","clock","performance","now","Date","calcDirection","xDistance","yDistance","calcDistance","point1","point2","GesturePlugin","evCache","startPoints","processEvent","throttleTimer","emitThrottles","_start","reset","startTime","pointerId_1","pointerId","existIdx","findIndex","item","splice","evTouches","nativeEvent","touches","_loop_1","find","touch","identifier","startDistance","pressTimeout","eventType","direction","deltaX","deltaY","emitStart","movingTarget","_move","clearPressTimeout","len","prevMoveTime","lastMoveTime","prevMovePoint","lastMovePoint","startPoint","getEventType","refreshAndGetTarget","currentDistance","zoom","_throttleEmit","_end","emitEnd","intervalTime","velocity","undefined","_cancel","getGestureEventTarget","isDocumentGestureEnabled","handlePointermove","handlePointerup","handlePointercancel","handlePointercanceloutside","isPanListenerInPath","ele","emitter","eventNames","includes","enable","isProcess","pushEvent","requestAnimationFrame","type_1","ev_1","newEvent","clearTimeout","SVGContextService","canvasConfig","$container","container","getElementById","$namespace","dpr","devicePixelRatio","ceil","getDPR","getBoundingClientRect","resize","applyCursorStyle","cursor","svgDocType","implementation","createDocumentType","svgDoc","createDocument","replaceChild","documentElement","encodeURIComponent","XMLSerializer","serializeToString","ContextRegisterPlugin","ContextService","Renderer","registerPlugin","SVGRenderer.Plugin","MobileInteraction.Plugin","SVGPicker.Plugin","DragDropEvent.Plugin","GesturePlugin.Plugin","AbstractRenderer"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,8]}